<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direct Google Maps Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section { 
            margin: 20px 0; 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 5px; 
            background: #f9f9f9;
        }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        .warning { background-color: #fff3cd; border-color: #ffeaa7; }
        #map { 
            width: 100%; 
            height: 400px; 
            border: 2px solid #007bff; 
            border-radius: 8px;
            background: #e9ecef;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover { background: #0056b3; }
        pre { 
            background-color: #f8f9fa; 
            padding: 15px; 
            border-radius: 4px; 
            overflow-x: auto; 
            border: 1px solid #e9ecef;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üó∫Ô∏è Direct Google Maps Test</h1>
        
        <div class="test-section info">
            <h3>üìã Test Status</h3>
            <div id="test-status" class="status">Initializing...</div>
        </div>

        <div class="test-section">
            <h3>üó∫Ô∏è Google Maps Display</h3>
            <div id="map"></div>
        </div>

        <div class="test-section">
            <h3>üîç Network Status</h3>
            <div id="network-status">
                <p>Checking network requests...</p>
            </div>
        </div>

        <div class="test-section">
            <h3>üìä Debug Information</h3>
            <pre id="debug-info">Loading debug information...</pre>
        </div>
    </div>

    <!-- Direct script inclusion -->
    <script>
        const API_KEY = 'AIzaSyAsAkznA2sJF0pp4iAq5H2uqP9FIATjdbk';
        
        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('test-status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            console.log(`[${new Date().toLocaleTimeString()}] ${message}`);
        }

        function updateDebugInfo() {
            const debugDiv = document.getElementById('debug-info');
            const debugData = {
                apiKey: API_KEY ? `${API_KEY.substring(0, 10)}...` : 'Not found',
                hasGoogle: !!window.google,
                hasGoogleMaps: !!(window.google && window.google.maps),
                currentUrl: window.location.href,
                userAgent: navigator.userAgent.substring(0, 100),
                timestamp: new Date().toISOString(),
                scripts: Array.from(document.scripts).map(s => s.src).filter(s => s.includes('maps.googleapis.com'))
            };
            
            debugDiv.textContent = JSON.stringify(debugData, null, 2);
        }

        function initMap() {
            try {
                updateStatus('üîÑ Initializing Google Maps...', 'warning');
                
                if (!window.google || !window.google.maps) {
                    throw new Error('Google Maps API not available');
                }

                const mapElement = document.getElementById('map');
                
                const map = new google.maps.Map(mapElement, {
                    zoom: 10,
                    center: { lat: 12.9716, lng: 77.5946 }, // Bangalore
                    mapTypeId: 'roadmap'
                });

                // Add a marker
                const marker = new google.maps.Marker({
                    position: { lat: 12.9716, lng: 77.5946 },
                    map: map,
                    title: 'Bangalore Test Marker'
                });

                // Add info window
                const infoWindow = new google.maps.InfoWindow({
                    content: '<div style="padding: 10px;"><h3>‚úÖ Google Maps Working!</h3><p>This is a test marker in Bangalore.</p></div>'
                });

                marker.addListener('click', () => {
                    infoWindow.open(map, marker);
                });

                updateStatus('‚úÖ Google Maps loaded successfully!', 'success');
                
            } catch (error) {
                updateStatus(`‚ùå Error: ${error.message}`, 'error');
                console.error('Map initialization error:', error);
            }
            
            updateDebugInfo();
        }

        function checkNetworkStatus() {
            const networkDiv = document.getElementById('network-status');
            const scripts = Array.from(document.scripts);
            const mapsScript = scripts.find(s => s.src && s.src.includes('maps.googleapis.com'));
            
            if (mapsScript) {
                networkDiv.innerHTML = `
                    <div class="success">
                        <p>‚úÖ Google Maps script found in DOM</p>
                        <p><strong>Source:</strong> ${mapsScript.src}</p>
                        <p><strong>Loaded:</strong> ${mapsScript.readyState || 'Unknown'}</p>
                    </div>
                `;
            } else {
                networkDiv.innerHTML = `
                    <div class="error">
                        <p>‚ùå Google Maps script not found in DOM</p>
                        <p>This suggests the script failed to load or was blocked</p>
                    </div>
                `;
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            updateStatus('üîÑ Page loaded, checking Google Maps...', 'warning');
            updateDebugInfo();
            checkNetworkStatus();
            
            // Check if Google Maps is already loaded
            if (window.google && window.google.maps) {
                updateStatus('‚úÖ Google Maps already loaded!', 'success');
                initMap();
            } else {
                updateStatus('‚è≥ Waiting for Google Maps to load...', 'warning');
                
                // Wait for Google Maps to load
                let attempts = 0;
                const checkInterval = setInterval(() => {
                    attempts++;
                    
                    if (window.google && window.google.maps) {
                        clearInterval(checkInterval);
                        updateStatus('‚úÖ Google Maps loaded!', 'success');
                        initMap();
                    } else if (attempts > 50) { // 10 seconds timeout
                        clearInterval(checkInterval);
                        updateStatus('‚ùå Google Maps failed to load after 10 seconds', 'error');
                        checkNetworkStatus();
                    }
                }, 200);
            }
        });

        // Update debug info every 2 seconds
        setInterval(() => {
            updateDebugInfo();
            checkNetworkStatus();
        }, 2000);
    </script>

    <!-- Load Google Maps API directly -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAsAkznA2sJF0pp4iAq5H2uqP9FIATjdbk&libraries=places&callback=initMap" async defer></script>
</body>
</html>
