<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Google Maps Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section { 
            margin: 20px 0; 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 5px; 
            background: #f9f9f9;
        }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        .warning { background-color: #fff3cd; border-color: #ffeaa7; }
        #map { 
            width: 100%; 
            height: 400px; 
            border: 2px solid #007bff; 
            border-radius: 8px;
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #666;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover { background: #0056b3; }
        pre { 
            background-color: #f8f9fa; 
            padding: 15px; 
            border-radius: 4px; 
            overflow-x: auto; 
            border: 1px solid #e9ecef;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üó∫Ô∏è Simple Google Maps Test</h1>
        
        <div class="test-section info">
            <h3>üìã Test Status</h3>
            <div id="test-status" class="status">Initializing...</div>
            <button class="btn" onclick="runTest()">üîÑ Run Test Again</button>
            <button class="btn" onclick="clearResults()">üóëÔ∏è Clear Results</button>
        </div>

        <div class="test-section">
            <h3>üó∫Ô∏è Google Maps Display</h3>
            <div id="map">Map will load here...</div>
        </div>

        <div class="test-section">
            <h3>üîç Console Logs</h3>
            <div id="console-logs">
                <p>Console logs will appear here...</p>
            </div>
        </div>

        <div class="test-section">
            <h3>üìä Debug Information</h3>
            <pre id="debug-info">Loading debug information...</pre>
        </div>
    </div>

    <script>
        const API_KEY = 'AIzaSyAsAkznA2sJF0pp4iAq5H2uqP9FIATjdbk';
        let testResults = [];
        let mapInstance = null;

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            testResults.push({ message: logEntry, type, timestamp });
            
            console.log(logEntry);
            updateConsoleLogs();
        }

        function updateConsoleLogs() {
            const logsDiv = document.getElementById('console-logs');
            logsDiv.innerHTML = testResults.map(result => 
                `<div class="${result.type}" style="margin: 5px 0; padding: 5px; border-radius: 3px;">
                    ${result.message}
                </div>`
            ).join('');
        }

        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('test-status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            log(message, type);
        }

        function updateDebugInfo() {
            const debugDiv = document.getElementById('debug-info');
            const debugData = {
                apiKey: API_KEY ? `${API_KEY.substring(0, 10)}...` : 'Not found',
                hasGoogle: !!window.google,
                hasGoogleMaps: !!(window.google && window.google.maps),
                currentUrl: window.location.href,
                userAgent: navigator.userAgent.substring(0, 100),
                timestamp: new Date().toISOString(),
                testResults: testResults.length,
                mapInstance: mapInstance ? 'Created' : 'Not created'
            };
            
            debugDiv.textContent = JSON.stringify(debugData, null, 2);
        }

        function initMap() {
            try {
                log('Initializing Google Maps...', 'info');
                
                if (!window.google || !window.google.maps) {
                    throw new Error('Google Maps API not loaded');
                }

                const mapElement = document.getElementById('map');
                mapElement.innerHTML = ''; // Clear loading text

                mapInstance = new google.maps.Map(mapElement, {
                    zoom: 10,
                    center: { lat: 12.9716, lng: 77.5946 }, // Bangalore
                    mapTypeId: 'roadmap',
                    styles: [
                        {
                            featureType: 'poi',
                            elementType: 'labels',
                            stylers: [{ visibility: 'off' }]
                        }
                    ]
                });

                // Add a marker
                const marker = new google.maps.Marker({
                    position: { lat: 12.9716, lng: 77.5946 },
                    map: mapInstance,
                    title: 'Bangalore Test Marker',
                    animation: google.maps.Animation.DROP
                });

                // Add info window
                const infoWindow = new google.maps.InfoWindow({
                    content: '<div style="padding: 10px;"><h3>‚úÖ Google Maps Working!</h3><p>This is a test marker in Bangalore.</p></div>'
                });

                marker.addListener('click', () => {
                    infoWindow.open(mapInstance, marker);
                });

                updateStatus('‚úÖ Google Maps loaded successfully!', 'success');
                log('Map instance created successfully', 'success');
                log('Marker added at Bangalore coordinates', 'success');
                
            } catch (error) {
                updateStatus(`‚ùå Error initializing map: ${error.message}`, 'error');
                log(`Map initialization error: ${error.message}`, 'error');
            }
            
            updateDebugInfo();
        }

        function loadGoogleMapsAPI() {
            log('Starting Google Maps API load process...', 'info');
            
            if (window.google && window.google.maps) {
                log('Google Maps API already loaded', 'success');
                initMap();
                return;
            }

            updateStatus('üîÑ Loading Google Maps API...', 'warning');
            
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=${API_KEY}&libraries=places&callback=initMap`;
            script.async = true;
            script.defer = true;
            
            script.onload = () => {
                log('Google Maps script loaded successfully', 'success');
                updateStatus('‚úÖ Google Maps script loaded!', 'success');
            };
            
            script.onerror = (error) => {
                const errorMsg = `Failed to load Google Maps API: ${error.message || 'Unknown error'}`;
                updateStatus(`‚ùå ${errorMsg}`, 'error');
                log(errorMsg, 'error');
                log('This might be due to:', 'error');
                log('- API key restrictions (domain, IP, referrer)', 'error');
                log('- Billing issues with Google Cloud Console', 'error');
                log('- Network connectivity issues', 'error');
                log('- Invalid API key', 'error');
                
                // Show helpful message in map area
                document.getElementById('map').innerHTML = `
                    <div style="text-align: center; color: #dc3545;">
                        <h3>‚ùå Google Maps Failed to Load</h3>
                        <p>Possible causes:</p>
                        <ul style="text-align: left; display: inline-block;">
                            <li>API key restrictions</li>
                            <li>Billing issues</li>
                            <li>Network problems</li>
                            <li>Invalid API key</li>
                        </ul>
                        <p><strong>Check browser console for detailed errors</strong></p>
                    </div>
                `;
            };
            
            document.head.appendChild(script);
            log(`Loading script from: ${script.src}`, 'info');
        }

        function runTest() {
            testResults = [];
            updateStatus('üîÑ Running test...', 'warning');
            log('=== Starting new test run ===', 'info');
            
            // Clear existing script if any
            const existingScript = document.querySelector('script[src*="maps.googleapis.com"]');
            if (existingScript) {
                existingScript.remove();
                log('Removed existing Google Maps script', 'info');
            }
            
            // Reset map element
            document.getElementById('map').innerHTML = 'Loading Google Maps...';
            
            // Load Google Maps
            loadGoogleMapsAPI();
        }

        function clearResults() {
            testResults = [];
            updateConsoleLogs();
            updateStatus('Results cleared', 'info');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            log('Page loaded, starting test...', 'info');
            updateDebugInfo();
            runTest();
        });

        // Update debug info every 2 seconds
        setInterval(updateDebugInfo, 2000);
    </script>
</body>
</html>
