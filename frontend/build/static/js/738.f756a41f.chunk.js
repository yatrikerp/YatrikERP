/*! For license information please see 738.f756a41f.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkyatrik_erp_frontend=self.webpackChunkyatrik_erp_frontend||[]).push([[738],{3923:()=>{},9738:(e,s,a)=>{a.r(s),a.d(s,{default:()=>y});var l=a(9379),r=a(5043),d=(a(8729),a(3540)),i=(a(3923),a(1360)),n=a(7365),c=a(2054);const t=(0,a(7784).A)("repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);var u=a(9292),o=a(2244),h=a(5088),v=a(5087),m=a(6533),x=a(9855),j=a(614),N=a(7819),p=a(579);const y=()=>{var e,s,a,y;const[b,g]=(0,r.useState)([]),[A,C]=(0,r.useState)(!0),[f,S]=(0,r.useState)(!1),[I,k]=(0,r.useState)(!1),[T,w]=(0,r.useState)(!1),[K,L]=(0,r.useState)(null),[z,B]=(0,r.useState)(""),[q,D]=(0,r.useState)("all"),[_,M]=(0,r.useState)({routeId:"",busId:"",driverId:"",conductorId:"",departureTime:"",arrivalTime:"",frequency:"daily",status:"active"});(0,r.useEffect)(()=>{W()},[]);const W=async()=>{try{C(!0);const e=await d.cV.getSchedules();console.log("Bus Scheduling - API response:",e);let s=[];if(e.success&&e.data?s=Array.isArray(e.data)?e.data:e.data.schedules||[]:Array.isArray(e)?s=e:e.schedules&&(s=e.schedules),console.log("Bus Scheduling - Parsed schedules:",s),0===s.length){g([{_id:"schedule1",scheduleNumber:"SCH-001",routeId:{routeName:"Kochi to Thiruvananthapuram",routeNumber:"KL-001"},busId:{busNumber:"KL-76-AB-5114",registrationNumber:"KL76AB9955"},driverId:{name:"Rajesh Kumar"},conductorId:{name:"Suresh Nair"},departureTime:"06:00",arrivalTime:"10:30",frequency:"daily",status:"active",daysOfWeek:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]},{_id:"schedule2",scheduleNumber:"SCH-002",routeId:{routeName:"Kochi to Kozhikode",routeNumber:"KL-002"},busId:{busNumber:"KL-76-AB-5115",registrationNumber:"KL76AB9956"},driverId:{name:"Manoj Pillai"},conductorId:{name:"Anil Kumar"},departureTime:"08:00",arrivalTime:"11:45",frequency:"daily",status:"active",daysOfWeek:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]},{_id:"schedule3",scheduleNumber:"SCH-003",routeId:{routeName:"Thiruvananthapuram to Kozhikode",routeNumber:"KL-003"},busId:{busNumber:"KL-76-AB-5116",registrationNumber:"KL76AB9957"},driverId:{name:"Vijay Menon"},conductorId:{name:"Ravi Nair"},departureTime:"14:00",arrivalTime:"20:15",frequency:"daily",status:"active",daysOfWeek:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]}])}else g(s)}catch(e){console.error("Error fetching schedules in BusScheduling:",e);g([{_id:"schedule1",scheduleNumber:"SCH-001",routeId:{routeName:"Kochi to Thiruvananthapuram",routeNumber:"KL-001"},busId:{busNumber:"KL-76-AB-5114",registrationNumber:"KL76AB9955"},driverId:{name:"Rajesh Kumar"},conductorId:{name:"Suresh Nair"},departureTime:"06:00",arrivalTime:"10:30",frequency:"daily",status:"active",daysOfWeek:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]}])}finally{C(!1)}},F=b.filter(e=>{var s,a,l,r,d,i,n;const c=(null===(s=e.scheduleNumber)||void 0===s?void 0:s.toLowerCase().includes(z.toLowerCase()))||(null===(a=e.routeId)||void 0===a||null===(l=a.routeName)||void 0===l?void 0:l.toLowerCase().includes(z.toLowerCase()))||(null===(r=e.busId)||void 0===r||null===(d=r.busNumber)||void 0===d?void 0:d.toLowerCase().includes(z.toLowerCase()))||(null===(i=e.driverId)||void 0===i||null===(n=i.name)||void 0===n?void 0:n.toLowerCase().includes(z.toLowerCase())),t="all"===q||e.status===q;return c&&t});return A?(0,p.jsx)("div",{className:"bus-scheduling",children:(0,p.jsxs)("div",{className:"page-header",children:[(0,p.jsx)("h1",{children:"Bus Scheduling"}),(0,p.jsx)("p",{children:"Loading schedules..."})]})}):(0,p.jsxs)("div",{className:"bus-scheduling",children:[(0,p.jsx)("div",{className:"page-header",children:(0,p.jsxs)("div",{className:"header-content",children:[(0,p.jsxs)("div",{className:"header-text",children:[(0,p.jsx)("h1",{children:"Bus Scheduling"}),(0,p.jsx)("p",{children:"Manage bus schedules, timings, and recurring trips"})]}),(0,p.jsxs)("button",{className:"add-schedule-btn",onClick:()=>S(!0),children:[(0,p.jsx)(i.A,{size:20}),"Create Schedule"]})]})}),(0,p.jsxs)("div",{className:"stats-grid",children:[(0,p.jsxs)("div",{className:"stat-card",children:[(0,p.jsx)("div",{className:"stat-icon blue",children:(0,p.jsx)(n.A,{size:24})}),(0,p.jsxs)("div",{className:"stat-content",children:[(0,p.jsx)("h3",{children:"Total Schedules"}),(0,p.jsx)("div",{className:"stat-value",children:b.length})]})]}),(0,p.jsxs)("div",{className:"stat-card",children:[(0,p.jsx)("div",{className:"stat-icon green",children:(0,p.jsx)(c.A,{size:24})}),(0,p.jsxs)("div",{className:"stat-content",children:[(0,p.jsx)("h3",{children:"Active Schedules"}),(0,p.jsx)("div",{className:"stat-value",children:b.filter(e=>"active"===e.status).length})]})]}),(0,p.jsxs)("div",{className:"stat-card",children:[(0,p.jsx)("div",{className:"stat-icon yellow",children:(0,p.jsx)(t,{size:24})}),(0,p.jsxs)("div",{className:"stat-content",children:[(0,p.jsx)("h3",{children:"Daily Schedules"}),(0,p.jsx)("div",{className:"stat-value",children:b.filter(e=>"daily"===e.frequency).length})]})]})]}),(0,p.jsx)("div",{className:"search-filter-bar",children:(0,p.jsxs)("div",{className:"search-row",children:[(0,p.jsxs)("div",{className:"search-input-container",children:[(0,p.jsx)(u.A,{size:20,className:"search-icon"}),(0,p.jsx)("input",{type:"text",placeholder:"Search schedules, routes, buses...",value:z,onChange:e=>B(e.target.value),className:"search-input"})]}),(0,p.jsxs)("select",{value:q,onChange:e=>D(e.target.value),className:"filter-select",children:[(0,p.jsx)("option",{value:"all",children:"All Status"}),(0,p.jsx)("option",{value:"active",children:"Active"}),(0,p.jsx)("option",{value:"inactive",children:"Inactive"})]})]})}),(0,p.jsxs)("div",{className:"schedules-table-container",children:[(0,p.jsx)("div",{className:"table-header",children:(0,p.jsxs)("h3",{children:["Schedules (",F.length,")"]})}),(0,p.jsx)("div",{className:"table-wrapper",children:(0,p.jsxs)("table",{className:"schedules-table",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:"Schedule ID"}),(0,p.jsx)("th",{children:"Route"}),(0,p.jsx)("th",{children:"Bus"}),(0,p.jsx)("th",{children:"Driver"}),(0,p.jsx)("th",{children:"Conductor"}),(0,p.jsx)("th",{children:"Departure"}),(0,p.jsx)("th",{children:"Arrival"}),(0,p.jsx)("th",{children:"Frequency"}),(0,p.jsx)("th",{children:"Status"}),(0,p.jsx)("th",{children:"Actions"})]})}),(0,p.jsx)("tbody",{children:F.length>0?F.map((e,s)=>{var a,l,r,d,i,n,c;return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("div",{className:"schedule-id",children:(0,p.jsx)("span",{className:"id",children:e.scheduleNumber})})}),(0,p.jsx)("td",{children:(0,p.jsxs)("div",{className:"schedule-route",children:[(0,p.jsx)("span",{className:"name",children:null===(a=e.routeId)||void 0===a?void 0:a.routeName}),(0,p.jsx)("span",{className:"route-number",children:null===(l=e.routeId)||void 0===l?void 0:l.routeNumber})]})}),(0,p.jsx)("td",{children:(0,p.jsxs)("div",{className:"schedule-bus",children:[(0,p.jsx)(o.A,{size:16}),(0,p.jsx)("span",{children:null===(r=e.busId)||void 0===r?void 0:r.busNumber})]})}),(0,p.jsx)("td",{children:(0,p.jsx)("div",{className:"schedule-driver",children:(0,p.jsx)("span",{children:null===(d=e.driverId)||void 0===d?void 0:d.name})})}),(0,p.jsx)("td",{children:(0,p.jsx)("div",{className:"schedule-conductor",children:(0,p.jsx)("span",{children:null===(i=e.conductorId)||void 0===i?void 0:i.name})})}),(0,p.jsx)("td",{children:(0,p.jsxs)("div",{className:"schedule-departure",children:[(0,p.jsx)(h.A,{size:16}),(0,p.jsx)("span",{children:e.departureTime})]})}),(0,p.jsx)("td",{children:(0,p.jsxs)("div",{className:"schedule-arrival",children:[(0,p.jsx)(h.A,{size:16}),(0,p.jsx)("span",{children:e.arrivalTime})]})}),(0,p.jsx)("td",{children:(0,p.jsxs)("div",{className:"schedule-frequency",children:[(0,p.jsx)(t,{size:16}),(0,p.jsx)("span",{children:e.frequency})]})}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{className:"status-badge ".concat(e.status||"unknown"),children:(null===(n=e.status)||void 0===n?void 0:n.charAt(0).toUpperCase())+(null===(c=e.status)||void 0===c?void 0:c.slice(1))})}),(0,p.jsx)("td",{children:(0,p.jsxs)("div",{className:"action-buttons",children:[(0,p.jsxs)("button",{className:"action-btn view",onClick:()=>{L(e)},children:[(0,p.jsx)(v.A,{size:16}),"View"]}),(0,p.jsxs)("button",{className:"action-btn edit",onClick:()=>{L(e),k(!0)},children:[(0,p.jsx)(m.A,{size:16}),"Edit"]}),(0,p.jsxs)("button",{className:"action-btn delete",onClick:()=>{L(e),w(!0)},children:[(0,p.jsx)(x.A,{size:16}),"Delete"]})]})})]},e._id||s)}):(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:"10",className:"no-data",children:(0,p.jsxs)("div",{className:"empty-state",children:[(0,p.jsx)(n.A,{size:48}),(0,p.jsx)("h3",{children:"No schedules found"}),(0,p.jsx)("p",{children:"No schedules match your search criteria"})]})})})})]})})]}),f&&(0,p.jsx)("div",{className:"modal-overlay",onClick:()=>S(!1),children:(0,p.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,p.jsxs)("div",{className:"modal-header",children:[(0,p.jsx)("h2",{children:"Create New Schedule"}),(0,p.jsx)("button",{className:"modal-close",onClick:()=>S(!1),children:(0,p.jsx)(j.A,{size:20})})]}),(0,p.jsxs)("div",{className:"modal-body",children:[(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Route"}),(0,p.jsxs)("select",{value:_.routeId,onChange:e=>M((0,l.A)((0,l.A)({},_),{},{routeId:e.target.value})),children:[(0,p.jsx)("option",{value:"",children:"Select Route"}),(0,p.jsx)("option",{value:"route1",children:"Kochi to Thiruvananthapuram"}),(0,p.jsx)("option",{value:"route2",children:"Kochi to Kozhikode"})]})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Bus"}),(0,p.jsxs)("select",{value:_.busId,onChange:e=>M((0,l.A)((0,l.A)({},_),{},{busId:e.target.value})),children:[(0,p.jsx)("option",{value:"",children:"Select Bus"}),(0,p.jsx)("option",{value:"bus1",children:"KL-76-AB-5114"}),(0,p.jsx)("option",{value:"bus2",children:"KL-76-AB-5115"})]})]}),(0,p.jsxs)("div",{className:"form-row",children:[(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Driver"}),(0,p.jsxs)("select",{value:_.driverId,onChange:e=>M((0,l.A)((0,l.A)({},_),{},{driverId:e.target.value})),children:[(0,p.jsx)("option",{value:"",children:"Select Driver"}),(0,p.jsx)("option",{value:"driver1",children:"Rajesh Kumar"}),(0,p.jsx)("option",{value:"driver2",children:"Manoj Pillai"})]})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Conductor"}),(0,p.jsxs)("select",{value:_.conductorId,onChange:e=>M((0,l.A)((0,l.A)({},_),{},{conductorId:e.target.value})),children:[(0,p.jsx)("option",{value:"",children:"Select Conductor"}),(0,p.jsx)("option",{value:"conductor1",children:"Suresh Nair"}),(0,p.jsx)("option",{value:"conductor2",children:"Anil Kumar"})]})]})]}),(0,p.jsxs)("div",{className:"form-row",children:[(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Departure Time"}),(0,p.jsx)("input",{type:"time",value:_.departureTime,onChange:e=>M((0,l.A)((0,l.A)({},_),{},{departureTime:e.target.value}))})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Arrival Time"}),(0,p.jsx)("input",{type:"time",value:_.arrivalTime,onChange:e=>M((0,l.A)((0,l.A)({},_),{},{arrivalTime:e.target.value}))})]})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Frequency"}),(0,p.jsxs)("select",{value:_.frequency,onChange:e=>M((0,l.A)((0,l.A)({},_),{},{frequency:e.target.value})),children:[(0,p.jsx)("option",{value:"daily",children:"Daily"}),(0,p.jsx)("option",{value:"weekly",children:"Weekly"}),(0,p.jsx)("option",{value:"monthly",children:"Monthly"})]})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Status"}),(0,p.jsxs)("select",{value:_.status,onChange:e=>M((0,l.A)((0,l.A)({},_),{},{status:e.target.value})),children:[(0,p.jsx)("option",{value:"active",children:"Active"}),(0,p.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]}),(0,p.jsxs)("div",{className:"modal-actions",children:[(0,p.jsx)("button",{className:"btn btn-secondary",onClick:()=>S(!1),children:"Cancel"}),(0,p.jsx)("button",{className:"btn btn-primary",onClick:async()=>{try{const e=(0,l.A)((0,l.A)({},_),{},{_id:"schedule_".concat(Date.now()),scheduleNumber:"SCH-".concat(String(b.length+1).padStart(3,"0")),daysOfWeek:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]});g([...b,e]),S(!1),M({routeId:"",busId:"",driverId:"",conductorId:"",departureTime:"",arrivalTime:"",frequency:"daily",status:"active"})}catch(e){console.error("Error adding schedule:",e)}},children:"Create Schedule"})]})]})}),I&&K&&(0,p.jsx)("div",{className:"modal-overlay",onClick:()=>k(!1),children:(0,p.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,p.jsxs)("div",{className:"modal-header",children:[(0,p.jsx)("h2",{children:"Edit Schedule"}),(0,p.jsx)("button",{className:"modal-close",onClick:()=>k(!1),children:(0,p.jsx)(j.A,{size:20})})]}),(0,p.jsxs)("div",{className:"modal-body",children:[(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Schedule Number"}),(0,p.jsx)("input",{type:"text",value:K.scheduleNumber,disabled:!0})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Route"}),(0,p.jsx)("input",{type:"text",value:null===(e=K.routeId)||void 0===e?void 0:e.routeName,disabled:!0})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Bus"}),(0,p.jsx)("input",{type:"text",value:null===(s=K.busId)||void 0===s?void 0:s.busNumber,disabled:!0})]}),(0,p.jsxs)("div",{className:"form-row",children:[(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Driver"}),(0,p.jsx)("input",{type:"text",value:null===(a=K.driverId)||void 0===a?void 0:a.name,disabled:!0})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Conductor"}),(0,p.jsx)("input",{type:"text",value:null===(y=K.conductorId)||void 0===y?void 0:y.name,disabled:!0})]})]}),(0,p.jsxs)("div",{className:"form-row",children:[(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Departure Time"}),(0,p.jsx)("input",{type:"time",value:K.departureTime,onChange:e=>L((0,l.A)((0,l.A)({},K),{},{departureTime:e.target.value}))})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Arrival Time"}),(0,p.jsx)("input",{type:"time",value:K.arrivalTime,onChange:e=>L((0,l.A)((0,l.A)({},K),{},{arrivalTime:e.target.value}))})]})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Frequency"}),(0,p.jsxs)("select",{value:K.frequency,onChange:e=>L((0,l.A)((0,l.A)({},K),{},{frequency:e.target.value})),children:[(0,p.jsx)("option",{value:"daily",children:"Daily"}),(0,p.jsx)("option",{value:"weekly",children:"Weekly"}),(0,p.jsx)("option",{value:"monthly",children:"Monthly"})]})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Status"}),(0,p.jsxs)("select",{value:K.status,onChange:e=>L((0,l.A)((0,l.A)({},K),{},{status:e.target.value})),children:[(0,p.jsx)("option",{value:"active",children:"Active"}),(0,p.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]}),(0,p.jsxs)("div",{className:"modal-actions",children:[(0,p.jsx)("button",{className:"btn btn-secondary",onClick:()=>k(!1),children:"Cancel"}),(0,p.jsx)("button",{className:"btn btn-primary",onClick:async()=>{try{const e=b.map(e=>e._id===K._id?(0,l.A)((0,l.A)({},e),K):e);g(e),k(!1),L(null)}catch(e){console.error("Error editing schedule:",e)}},children:"Save Changes"})]})]})}),T&&K&&(0,p.jsx)("div",{className:"modal-overlay",onClick:()=>w(!1),children:(0,p.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,p.jsxs)("div",{className:"modal-header",children:[(0,p.jsx)("h2",{children:"Delete Schedule"}),(0,p.jsx)("button",{className:"modal-close",onClick:()=>w(!1),children:(0,p.jsx)(j.A,{size:20})})]}),(0,p.jsx)("div",{className:"modal-body",children:(0,p.jsxs)("div",{className:"delete-confirmation",children:[(0,p.jsx)(N.A,{size:48,className:"warning-icon"}),(0,p.jsx)("h3",{children:"Are you sure?"}),(0,p.jsxs)("p",{children:["You are about to delete the schedule ",(0,p.jsx)("strong",{children:K.scheduleNumber}),". This action cannot be undone."]})]})}),(0,p.jsxs)("div",{className:"modal-actions",children:[(0,p.jsx)("button",{className:"btn btn-secondary",onClick:()=>w(!1),children:"Cancel"}),(0,p.jsx)("button",{className:"btn btn-danger",onClick:async()=>{try{const e=b.filter(e=>e._id!==K._id);g(e),w(!1),L(null)}catch(e){console.error("Error deleting schedule:",e)}},children:"Delete Schedule"})]})]})})]})}}}]);
//# sourceMappingURL=738.f756a41f.chunk.js.map