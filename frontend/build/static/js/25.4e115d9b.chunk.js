/*! For license information please see 25.4e115d9b.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkyatrik_erp_frontend=self.webpackChunkyatrik_erp_frontend||[]).push([[25],{3025:(e,s,a)=>{a.r(s),a.d(s,{default:()=>O});var i=a(9379),l=a(5043),n=a(8729),t=a(3862),c=a(3829),r=a(614),d=a(5088),o=a(7719),u=a(6401),m=a(5087),h=a(9292),v=a(2284),x=a(4105),p=a(516),j=a(7104),b=a(2580),g=a(8693),N=a(7784);const y=(0,N.A)("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var f=a(2811),A=a(1884);const C=(0,N.A)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var k=a(9855),w=a(4991),S=a(6210),M=a(4830),T=a(6533),z=a(5686),D=a(2313),R=a(8006),_=a(5711),B=a(2382),F=a(1680),E=a(7033),L=a(4537),I=a(4919),P=a(579);const O=()=>{var e,s,a,N,O;const{user:q}=(0,n.A)(),[U,H]=(0,l.useState)([]),[V,J]=(0,l.useState)(!0),[Y,K]=(0,l.useState)(!1),[G,W]=(0,l.useState)(!1),[Q,X]=(0,l.useState)(!1),[Z,$]=(0,l.useState)(null),[ee,se]=(0,l.useState)(""),[ae,ie]=(0,l.useState)("busNumber"),[le,ne]=(0,l.useState)("asc"),[te,ce]=(0,l.useState)([]),[re,de]=(0,l.useState)("table"),[oe,ue]=(0,l.useState)(!1),[me,he]=(0,l.useState)(1),[ve,xe]=(0,l.useState)(10),[pe,je]=(0,l.useState)({totalBuses:0,availableBuses:0,maintenanceBuses:0,activeBuses:0}),[be,ge]=(0,l.useState)(null),[Ne,ye]=(0,l.useState)([]),[fe,Ae]=(0,l.useState)(!1),[Ce,ke]=(0,l.useState)([]),[we,Se]=(0,l.useState)(!1),[Me,Te]=(0,l.useState)([]),[ze,De]=(0,l.useState)([]),[Re,_e]=(0,l.useState)(!1),[Be,Fe]=(0,l.useState)(!1),[Ee,Le]=(0,l.useState)(!1),[Ie,Pe]=(0,l.useState)(!1),[Oe,qe]=(0,l.useState)(!0),[Ue,He]=(0,l.useState)([]),[Ve,Je]=(0,l.useState)("default"),[Ye,Ke]=(0,l.useState)([]),[Ge,We]=(0,l.useState)({totalTrips:0,totalKm:0,avgFuelEfficiency:0,downtimeHours:0}),[Qe,Xe]=(0,l.useState)({busNumber:"",registrationNumber:"",busType:"ac_seater",capacity:{total:0,sleeper:0,seater:0,ladies:0,disabled:0},amenities:[],specifications:{manufacturer:"",model:"",year:(new Date).getFullYear(),engine:"",fuelType:"diesel",mileage:0,maxSpeed:0,length:0,width:0,height:0},assignedDriver:"",assignedConductor:"",notes:""}),[Ze,$e]=(0,l.useState)({status:"all",type:"all",capacityRange:{min:0,max:100},depot:"all",lastMaintenance:"all",assignedCrew:"all"}),[es,ss]=(0,l.useState)({busId:"",problemType:"",description:"",assignedMechanic:"",estimatedReturnTime:"",priority:"medium",partsRequired:[],estimatedCost:0}),as=[{value:"ac_sleeper",label:"AC Sleeper"},{value:"ac_seater",label:"AC Seater"},{value:"non_ac_sleeper",label:"Non-AC Sleeper"},{value:"non_ac_seater",label:"Non-AC Seater"},{value:"volvo",label:"Volvo"},{value:"mini",label:"Mini Bus"}],is=[{value:"wifi",label:"WiFi"},{value:"charging",label:"Charging Points"},{value:"entertainment",label:"Entertainment"},{value:"refreshments",label:"Refreshments"},{value:"toilet",label:"Toilet"},{value:"ac",label:"Air Conditioning"},{value:"heating",label:"Heating"}],ls=[{value:"diesel",label:"Diesel"},{value:"petrol",label:"Petrol"},{value:"cng",label:"CNG"},{value:"electric",label:"Electric"},{value:"hybrid",label:"Hybrid"}],ns={active:{bg:"#E8F5E9",color:"#00A86B",icon:"\ud83d\udfe2"},maintenance:{bg:"#FFF8E1",color:"#FFB300",icon:"\ud83d\udfe1"},breakdown:{bg:"#FFEBEE",color:"#F44336",icon:"\ud83d\udd34"},idle:{bg:"#F5F5F5",color:"#9E9E9E",icon:"\u26aa"},retired:{bg:"#F3F4F6",color:"#6B7280",icon:"\u26ab"}},ts=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;const i=Date.now()+Math.random(),l={id:i,message:e,type:s,duration:a};ye(e=>[...e,l]),setTimeout(()=>{ye(e=>e.filter(e=>e.id!==i))},a)},cs=e=>{ye(s=>s.filter(s=>s.id!==e))},rs=(0,l.useCallback)(e=>{var s;return(null===(s=as.find(s=>s.value===e))||void 0===s?void 0:s.label)||e},[as]),ds=e=>{switch(e){case"active":return"green";case"maintenance":return"orange";case"retired":return"red";default:return"gray"}},os=(0,l.useCallback)(()=>{const e=[],s=new Date;U.forEach(a=>{if(a.lastMaintenance){const i=new Date(a.lastMaintenance),l=Math.floor((s-i)/864e5);l>=330&&e.push({id:"fc-".concat(a._id),type:"warning",busId:a._id,busNumber:a.busNumber,message:"Bus ".concat(a.busNumber," due for FC renewal in ").concat(365-l," days"),icon:"\ud83d\udccb",priority:l>=350?"high":"medium"})}if(a.recentTrips&&a.recentTrips.length>=3){const s=a.recentTrips.reduce((e,s)=>e+s.mileage,0)/a.recentTrips.length;s<50&&e.push({id:"mileage-".concat(a._id),type:"info",busId:a._id,busNumber:a.busNumber,message:"Bus ".concat(a.busNumber," low mileage trend last 3 trips (avg: ").concat(s.toFixed(1),"km)"),icon:"\u26fd",priority:"medium"})}if(a.nextMaintenance){const i=new Date(a.nextMaintenance),l=Math.floor((i-s)/864e5);l<=7&&e.push({id:"scheduled-".concat(a._id),type:"info",busId:a._id,busNumber:a.busNumber,message:"Bus ".concat(a.busNumber," scheduled for maintenance ").concat(0===l?"today":"in ".concat(l," days")),icon:"\ud83d\udee0\ufe0f",priority:l<=1?"high":"medium"})}}),Ke(e)},[U]),us=(0,l.useCallback)(async()=>{try{console.log("Maintenance logs would be fetched here")}catch(e){console.error("Error fetching maintenance logs:",e)}},[]),ms=(0,l.useCallback)(async()=>{try{const e={totalTrips:U.filter(e=>"active"===e.status).length,totalKm:U.reduce((e,s)=>e+(s.totalKm||0),0),avgFuelEfficiency:U.length>0?U.reduce((e,s)=>e+(s.fuelEfficiency||0),0)/U.length:0,downtimeHours:24*U.filter(e=>"maintenance"===e.status).length};We(e)}catch(e){console.error("Error calculating fleet stats:",e)}},[U]),hs=(0,l.useCallback)(async()=>{try{J(!0);const l=localStorage.getItem("depotToken"),n=localStorage.getItem("token");console.log("Debug - Tokens available:",{depotToken:!!l,token:!!n,user:q});const c=await(0,t.nr)("/api/depot/buses");var e,s,a,i;if(c.ok)H((null===(e=c.data)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.buses)||[]),je((null===(a=c.data)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.stats)||{});else console.error("Failed to load buses:",c.status,c.message)}catch(l){console.error("Error fetching buses:",l)}finally{J(!1)}},[q]),vs=(0,l.useCallback)(async()=>{Se(!0);try{var e,s;const a=await(0,t.nr)("/api/admin/routes?status=active");a.ok&&null!==(e=a.data)&&void 0!==e&&null!==(s=e.data)&&void 0!==s&&s.routes?ke(a.data.data.routes):a.ok&&Array.isArray(a.data)&&ke(a.data)}catch(a){console.error("Error fetching routes:",a),ts("Failed to load routes","error")}finally{Se(!1)}},[]);(0,l.useEffect)(()=>{hs(),(async()=>{_e(!0);try{var e,s,a,i,l,n;const[c,r]=await Promise.all([(0,t.nr)("/api/admin/all-drivers"),(0,t.nr)("/api/admin/all-conductors")]);console.log("Drivers response:",c),console.log("Conductors response:",r),null!==c&&void 0!==c&&c.ok&&null!==(e=c.data)&&void 0!==e&&null!==(s=e.data)&&void 0!==s&&s.drivers?Te(c.data.data.drivers):null!==c&&void 0!==c&&null!==(a=c.data)&&void 0!==a&&a.drivers?Te(c.data.drivers):(console.warn("No drivers data found in response"),Te([])),null!==r&&void 0!==r&&r.ok&&null!==(i=r.data)&&void 0!==i&&null!==(l=i.data)&&void 0!==l&&l.conductors?De(r.data.data.conductors):null!==r&&void 0!==r&&null!==(n=r.data)&&void 0!==n&&n.conductors?De(r.data.conductors):(console.warn("No conductors data found in response"),De([]))}catch(c){console.error("Error fetching staff data:",c),Te([]),De([])}finally{_e(!1)}})(),vs(),us()},[hs,vs,us]),(0,l.useEffect)(()=>{ms()},[ms]),(0,l.useEffect)(()=>{os()},[os]),(0,l.useEffect)(()=>{const e=e=>{be&&!e.target.closest(".actions-dropdown")&&ge(null)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[be]);const xs=()=>{Xe({busNumber:"",registrationNumber:"",busType:"ac_seater",capacity:{total:0,sleeper:0,seater:0,ladies:0,disabled:0},amenities:[],specifications:{manufacturer:"",model:"",year:(new Date).getFullYear(),engine:"",fuelType:"diesel",mileage:0,maxSpeed:0,length:0,width:0,height:0},assignedDriver:"",assignedConductor:"",notes:""})},ps=e=>{$(e),Xe({busNumber:e.busNumber,registrationNumber:e.registrationNumber,busType:e.busType,capacity:e.capacity||{total:0,sleeper:0,seater:0,ladies:0,disabled:0},amenities:e.amenities||[],specifications:e.specifications||{manufacturer:"",model:"",year:(new Date).getFullYear(),engine:"",fuelType:"diesel",mileage:0,maxSpeed:0,length:0,width:0,height:0},assignedDriver:e.assignedDriver||"",assignedConductor:e.assignedConductor||"",notes:e.notes||""}),W(!0)},js=(e,s)=>{switch(e){case"duplicate":ts("Duplicating bus ".concat(s.busNumber,"..."),"info"),console.log("Duplicate bus:",s.busNumber);break;case"export":ts("Exporting data for bus ".concat(s.busNumber,"..."),"info"),console.log("Export bus data:",s.busNumber);break;case"history":ts("Loading maintenance history for bus ".concat(s.busNumber,"..."),"info"),console.log("View maintenance history:",s.busNumber);break;case"assign_route":$(s),Ae(!0);break;default:console.log("Unknown action:",e)}ge(null)},bs=(0,l.useMemo)(()=>{let e=U.filter(e=>{var s,a,i,l,n,t,c,r,d,o;const u=e.busNumber.toLowerCase().includes(ee.toLowerCase())||e.registrationNumber.toLowerCase().includes(ee.toLowerCase())||(null===(s=e.currentRoute)||void 0===s||null===(a=s.routeName)||void 0===a?void 0:a.toLowerCase().includes(ee.toLowerCase()))||(null===(i=e.currentRoute)||void 0===i||null===(l=i.routeNumber)||void 0===l?void 0:l.toLowerCase().includes(ee.toLowerCase()))||(null===(n=e.assignedDriver)||void 0===n||null===(t=n.name)||void 0===t?void 0:t.toLowerCase().includes(ee.toLowerCase()))||(null===(c=e.assignedConductor)||void 0===c||null===(r=c.name)||void 0===r?void 0:r.toLowerCase().includes(ee.toLowerCase())),m="all"===Ze.status||e.status===Ze.status,h="all"===Ze.type||e.busType===Ze.type,v=(null===(d=e.capacity)||void 0===d?void 0:d.total)>=Ze.capacityRange.min&&(null===(o=e.capacity)||void 0===o?void 0:o.total)<=Ze.capacityRange.max,x="all"===Ze.depot||e.depot===Ze.depot;let p=!0;if("all"!==Ze.lastMaintenance&&e.lastMaintenance){const s=new Date(e.lastMaintenance),a=Math.floor((new Date-s)/864e5);switch(Ze.lastMaintenance){case"recent":p=a<=30;break;case"overdue":p=a>365;break;case"due_soon":p=a>300&&a<=365;break;default:p=!0}}const j="all"===Ze.assignedCrew||"assigned"===Ze.assignedCrew&&e.assignedDriver&&e.assignedConductor||"unassigned"===Ze.assignedCrew&&(!e.assignedDriver||!e.assignedConductor);return u&&m&&h&&v&&x&&p&&j});return e.sort((e,s)=>{let a=e[ae],i=s[ae];var l,n;"route"===ae&&(a=(null===(l=e.currentRoute)||void 0===l?void 0:l.routeName)||"",i=(null===(n=s.currentRoute)||void 0===n?void 0:n.routeName)||"");return"string"===typeof a&&(a=a.toLowerCase(),i=i.toLowerCase()),a<i?"asc"===le?-1:1:a>i?"asc"===le?1:-1:0}),e},[U,ee,Ze,ae,le]),gs=(0,l.useMemo)(()=>{const e=(me-1)*ve;return bs.slice(e,e+ve)},[bs,me,ve]),Ns=Math.ceil(bs.length/ve),ys=(0,l.useCallback)(()=>{te.length===gs.length?ce([]):ce(gs.map(e=>e._id))},[te.length,gs]),fs=(0,l.useCallback)(e=>{ce(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},[]),As=(0,l.useCallback)(async e=>{if(0!==te.length)try{switch(e){case"activate":await Promise.all(te.map(e=>(0,t.nr)("/api/depot/buses/".concat(e),{method:"PUT",body:JSON.stringify({status:"active"})}))),ts("".concat(te.length," buses activated successfully!"),"success");break;case"maintenance":await Promise.all(te.map(e=>(0,t.nr)("/api/depot/buses/".concat(e),{method:"PUT",body:JSON.stringify({status:"maintenance"})}))),ts("".concat(te.length," buses sent to maintenance!"),"success");break;case"assign_route":if(1===te.length){const e=U.find(e=>e._id===te[0]);$(e),Ae(!0)}else ts("Please select only one bus to assign a route","warning");break;case"assign_crew":Le(!0);break;case"archive":await Promise.all(te.map(e=>(0,t.nr)("/api/depot/buses/".concat(e),{method:"PUT",body:JSON.stringify({status:"retired"})}))),ts("".concat(te.length," buses archived successfully!"),"success");break;case"delete":await Promise.all(te.map(e=>(0,t.nr)("/api/depot/buses/".concat(e),{method:"DELETE"}))),ts("".concat(te.length," buses deleted successfully!"),"success");break;default:console.log("Unknown bulk action:",e)}ce([]),hs()}catch(s){console.error("Bulk action failed:",s),ts("Bulk action failed. Please try again.","error")}},[te,hs]),Cs=(0,l.useCallback)(e=>{ae===e?ne(e=>"asc"===e?"desc":"asc"):(ie(e),ne("asc"))},[ae]),ks=(0,l.useCallback)(async(e,s)=>{try{const a=U.find(s=>s._id===e),i=a?a.busNumber:"Unknown";await(0,t.nr)("/api/depot/buses/".concat(e),{method:"PUT",body:JSON.stringify({status:s})}),hs();const l="active"===s?"activated":"sent to maintenance";ts("Bus ".concat(i," ").concat(l," successfully!"),"success")}catch(a){console.error("Status change failed:",a),ts("Failed to change bus status. Please try again.","error")}},[hs,U]),ws=(0,l.useCallback)(e=>{switch(Je(e),e){case"active_only":$e(e=>(0,i.A)((0,i.A)({},e),{},{status:"active"}));break;case"ac_buses":$e(e=>(0,i.A)((0,i.A)({},e),{},{type:"ac_seater",capacityRange:{min:50,max:100}}));break;case"maintenance_due":$e(e=>(0,i.A)((0,i.A)({},e),{},{status:"maintenance"}));break;case"idle_buses":$e(e=>(0,i.A)((0,i.A)({},e),{},{status:"idle"}));break;default:$e({status:"all",type:"all",capacityRange:{min:0,max:100},depot:"all",lastMaintenance:"all",assignedCrew:"all"})}},[]),Ss=(0,l.useCallback)(async e=>{e.preventDefault();try{console.log("Creating maintenance log:",es),ts("Maintenance log created successfully!","success"),Fe(!1),ss({busId:"",problemType:"",description:"",assignedMechanic:"",estimatedReturnTime:"",priority:"medium",partsRequired:[],estimatedCost:0}),es.busId&&await ks(es.busId,"maintenance")}catch(s){console.error("Error creating maintenance log:",s),ts("Failed to create maintenance log. Please try again.","error")}},[es,ks,U]),Ms=(0,l.useCallback)(e=>{ss(s=>(0,i.A)((0,i.A)({},s),{},{busId:e._id})),Fe(!0)},[]),Ts=(0,l.useCallback)(async e=>{try{if(console.log("Exporting fleet data as ".concat(e)),"excel"===e&&U.length>0){const e=U.map(e=>{var s,a,i,l;return{"Bus Number":e.busNumber,Registration:e.registrationNumber,Type:rs(e.busType),Capacity:(null===(s=e.capacity)||void 0===s?void 0:s.total)||0,Status:e.status,Driver:(null===(a=e.assignedDriver)||void 0===a?void 0:a.name)||"Unassigned",Conductor:(null===(i=e.assignedConductor)||void 0===i?void 0:i.name)||"Unassigned",Route:(null===(l=e.currentRoute)||void 0===l?void 0:l.routeName)||"No Route","Last Maintenance":e.lastMaintenance?new Date(e.lastMaintenance).toLocaleDateString():"N/A"}}),s=[Object.keys(e[0]).join(","),...e.map(e=>Object.values(e).join(","))].join("\n"),a=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(a),l=document.createElement("a");l.href=i,l.download="fleet-report-".concat((new Date).toISOString().split("T")[0],".csv"),document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(i)}else if("excel"===e)return void ts("No buses available to export","warning");ts("Fleet report exported successfully!","success")}catch(s){console.error("Export failed:",s),ts("Export failed. Please try again.","error")}},[U,rs]);return V?(0,P.jsxs)("div",{className:"fleet-loading",children:[(0,P.jsx)("div",{className:"loading-spinner"}),(0,P.jsx)("h3",{children:"Loading Fleet Management..."})]}):(0,P.jsxs)("div",{className:"fleet-management",children:[(0,P.jsx)("div",{className:"notification-container",children:Ne.map(e=>(0,P.jsx)("div",{className:"notification notification-".concat(e.type),onClick:()=>cs(e.id),children:(0,P.jsxs)("div",{className:"notification-content",children:[(0,P.jsxs)("div",{className:"notification-icon",children:["success"===e.type&&(0,P.jsx)(c.A,{size:16}),"error"===e.type&&(0,P.jsx)(r.A,{size:16}),"info"===e.type&&(0,P.jsx)(d.A,{size:16})]}),(0,P.jsx)("div",{className:"notification-message",children:e.message}),(0,P.jsx)("button",{className:"notification-close",onClick:s=>{s.stopPropagation(),cs(e.id)},children:(0,P.jsx)(r.A,{size:14})})]})},e.id))}),(0,P.jsxs)("div",{className:"dashboard-header",children:[(0,P.jsx)("div",{className:"header-left",children:(0,P.jsx)("h1",{children:"Fleet Management"})}),(0,P.jsx)("div",{className:"header-actions",children:(0,P.jsxs)("button",{className:"action-btn blue",onClick:()=>K(!0),children:[(0,P.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Add New Bus"]})})]}),(0,P.jsx)("div",{className:"kpi-section",children:(0,P.jsxs)("div",{className:"kpi-grid",children:[(0,P.jsxs)("div",{className:"kpi-card",children:[(0,P.jsx)("div",{className:"kpi-icon",children:(0,P.jsxs)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:[(0,P.jsx)("path",{d:"M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"}),(0,P.jsx)("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})]})}),(0,P.jsxs)("div",{className:"kpi-content",children:[(0,P.jsx)("div",{className:"kpi-value",children:pe.totalBuses}),(0,P.jsx)("div",{className:"kpi-label",children:"Total Buses"})]})]}),(0,P.jsxs)("div",{className:"kpi-card",children:[(0,P.jsx)("div",{className:"kpi-icon",children:(0,P.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,P.jsxs)("div",{className:"kpi-content",children:[(0,P.jsx)("div",{className:"kpi-value",children:pe.availableBuses}),(0,P.jsx)("div",{className:"kpi-label",children:"Available"})]})]}),(0,P.jsxs)("div",{className:"kpi-card",children:[(0,P.jsx)("div",{className:"kpi-icon",children:(0,P.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z",clipRule:"evenodd"})})}),(0,P.jsxs)("div",{className:"kpi-content",children:[(0,P.jsx)("div",{className:"kpi-value",children:pe.maintenanceBuses}),(0,P.jsx)("div",{className:"kpi-label",children:"In Maintenance"})]})]}),(0,P.jsxs)("div",{className:"kpi-card",children:[(0,P.jsx)("div",{className:"kpi-icon",children:(0,P.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),(0,P.jsxs)("div",{className:"kpi-content",children:[(0,P.jsx)("div",{className:"kpi-value",children:pe.activeBuses}),(0,P.jsx)("div",{className:"kpi-label",children:"Active Trips"})]})]})]})}),Oe&&Ye.length>0&&(0,P.jsxs)("div",{className:"predictive-insights",children:[(0,P.jsxs)("div",{className:"insights-header",children:[(0,P.jsxs)("div",{className:"insights-title",children:[(0,P.jsx)(o.A,{size:20}),(0,P.jsx)("h3",{children:"Predictive Insights"}),(0,P.jsx)("span",{className:"alert-count",children:Ye.length})]}),(0,P.jsx)("button",{className:"insights-toggle",onClick:()=>qe(!1),children:(0,P.jsx)(r.A,{size:16})})]}),(0,P.jsx)("div",{className:"alerts-grid",children:Ye.slice(0,6).map(e=>(0,P.jsxs)("div",{className:"alert-card ".concat(e.type," ").concat(e.priority),children:[(0,P.jsx)("div",{className:"alert-icon",children:e.icon}),(0,P.jsxs)("div",{className:"alert-content",children:[(0,P.jsx)("div",{className:"alert-message",children:e.message}),(0,P.jsxs)("div",{className:"alert-bus",children:["Bus: ",e.busNumber]})]}),(0,P.jsx)("div",{className:"alert-actions",children:(0,P.jsx)("button",{className:"alert-action-btn",onClick:()=>{const s=U.find(s=>s._id===e.busId);s&&("warning"===e.type?Ms(s):ps(s))},children:"warning"===e.type?(0,P.jsx)(u.A,{size:14}):(0,P.jsx)(m.A,{size:14})})})]},e.id))}),Ye.length>6&&(0,P.jsx)("div",{className:"insights-footer",children:(0,P.jsxs)("span",{className:"more-alerts",children:["+",Ye.length-6," more alerts"]})})]}),(0,P.jsxs)("div",{className:"search-section",children:[(0,P.jsxs)("div",{className:"search-input-wrapper",children:[(0,P.jsx)(h.A,{className:"search-icon",size:16}),(0,P.jsx)("input",{type:"text",className:"search-input",placeholder:"Search buses, routes, registration, crew...",value:ee,onChange:e=>se(e.target.value)}),ee&&(0,P.jsx)("button",{className:"clear-search",onClick:()=>se(""),children:(0,P.jsx)(r.A,{size:14})})]}),(0,P.jsxs)("div",{className:"filter-dropdowns",children:[(0,P.jsxs)("select",{className:"filter-dropdown",value:Ze.status,onChange:e=>$e(s=>(0,i.A)((0,i.A)({},s),{},{status:e.target.value})),children:[(0,P.jsx)("option",{value:"all",children:"All Status"}),(0,P.jsx)("option",{value:"active",children:"\ud83d\udfe2 Active"}),(0,P.jsx)("option",{value:"maintenance",children:"\ud83d\udfe1 Maintenance"}),(0,P.jsx)("option",{value:"breakdown",children:"\ud83d\udd34 Breakdown"}),(0,P.jsx)("option",{value:"idle",children:"\u26aa Idle"}),(0,P.jsx)("option",{value:"retired",children:"\u26ab Retired"})]}),(0,P.jsxs)("select",{className:"filter-dropdown",value:Ze.type,onChange:e=>$e(s=>(0,i.A)((0,i.A)({},s),{},{type:e.target.value})),children:[(0,P.jsx)("option",{value:"all",children:"All Types"}),as.map(e=>(0,P.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,P.jsxs)("select",{className:"filter-dropdown",value:Ze.assignedCrew,onChange:e=>$e(s=>(0,i.A)((0,i.A)({},s),{},{assignedCrew:e.target.value})),children:[(0,P.jsx)("option",{value:"all",children:"All Crew Status"}),(0,P.jsx)("option",{value:"assigned",children:"\ud83d\udc65 Assigned"}),(0,P.jsx)("option",{value:"unassigned",children:"\u274c Unassigned"})]}),(0,P.jsxs)("select",{className:"filter-dropdown",value:ve,onChange:e=>xe(Number(e.target.value)),children:[(0,P.jsx)("option",{value:5,children:"5 per page"}),(0,P.jsx)("option",{value:10,children:"10 per page"}),(0,P.jsx)("option",{value:25,children:"25 per page"}),(0,P.jsx)("option",{value:50,children:"50 per page"})]})]}),(0,P.jsxs)("div",{className:"view-controls",children:[(0,P.jsx)("div",{className:"filter-views",children:[{id:"default",name:"All Buses",icon:"\ud83d\udccb"},{id:"active_only",name:"Active Only",icon:"\ud83d\udfe2"},{id:"ac_buses",name:"AC Buses &gt;50 seats",icon:"\u2744\ufe0f"},{id:"maintenance_due",name:"Maintenance Due",icon:"\ud83d\udd27"},{id:"idle_buses",name:"Idle Buses",icon:"\u26aa"}].map(e=>(0,P.jsxs)("button",{className:"filter-view-btn ".concat(Ve===e.id?"active":""),onClick:()=>ws(e.id),title:e.name,children:[(0,P.jsx)("span",{className:"view-icon",children:e.icon}),(0,P.jsx)("span",{className:"view-name",children:e.name})]},e.id))}),(0,P.jsxs)("div",{className:"view-modes",children:[(0,P.jsx)("button",{className:"view-btn ".concat("table"===re?"active":""),onClick:()=>de("table"),title:"Table View",children:(0,P.jsx)(v.A,{size:16})}),(0,P.jsx)("button",{className:"view-btn ".concat("grid"===re?"active":""),onClick:()=>de("grid"),title:"Card View",children:(0,P.jsx)(x.A,{size:16})})]}),(0,P.jsx)("button",{className:"refresh-btn",onClick:hs,disabled:V,title:"Refresh Data",children:(0,P.jsx)(p.A,{size:16,className:V?"spinning":""})}),(0,P.jsx)("button",{className:"export-btn",onClick:()=>Pe(!0),title:"Export Data",children:(0,P.jsx)(j.A,{size:16})}),(0,P.jsxs)("button",{className:"filter-toggle",onClick:()=>ue(!oe),title:"Advanced Filters",children:[(0,P.jsx)(b.A,{size:16}),oe&&(0,P.jsx)("span",{className:"filter-count",children:"5"})]})]})]}),oe&&(0,P.jsxs)("div",{className:"advanced-filters-panel",children:[(0,P.jsxs)("div",{className:"filters-header",children:[(0,P.jsx)("h4",{children:"Advanced Filters"}),(0,P.jsx)("button",{className:"close-filters",onClick:()=>ue(!1),children:(0,P.jsx)(r.A,{size:16})})]}),(0,P.jsxs)("div",{className:"filters-grid",children:[(0,P.jsxs)("div",{className:"filter-group",children:[(0,P.jsx)("label",{children:"Capacity Range"}),(0,P.jsxs)("div",{className:"range-inputs",children:[(0,P.jsx)("input",{type:"number",placeholder:"Min",value:Ze.capacityRange.min,onChange:e=>$e(s=>(0,i.A)((0,i.A)({},s),{},{capacityRange:(0,i.A)((0,i.A)({},s.capacityRange),{},{min:parseInt(e.target.value)||0})}))}),(0,P.jsx)("span",{children:"to"}),(0,P.jsx)("input",{type:"number",placeholder:"Max",value:Ze.capacityRange.max,onChange:e=>$e(s=>(0,i.A)((0,i.A)({},s),{},{capacityRange:(0,i.A)((0,i.A)({},s.capacityRange),{},{max:parseInt(e.target.value)||100})}))})]})]}),(0,P.jsxs)("div",{className:"filter-group",children:[(0,P.jsx)("label",{children:"Last Maintenance"}),(0,P.jsxs)("select",{value:Ze.lastMaintenance,onChange:e=>$e(s=>(0,i.A)((0,i.A)({},s),{},{lastMaintenance:e.target.value})),children:[(0,P.jsx)("option",{value:"all",children:"All"}),(0,P.jsx)("option",{value:"recent",children:"Recent (\u226430 days)"}),(0,P.jsx)("option",{value:"due_soon",children:"Due Soon (300-365 days)"}),(0,P.jsx)("option",{value:"overdue",children:"Overdue (>365 days)"})]})]}),(0,P.jsxs)("div",{className:"filter-group",children:[(0,P.jsx)("label",{children:"Depot"}),(0,P.jsxs)("select",{value:Ze.depot,onChange:e=>$e(s=>(0,i.A)((0,i.A)({},s),{},{depot:e.target.value})),children:[(0,P.jsx)("option",{value:"all",children:"All Depots"}),(0,P.jsx)("option",{value:"main",children:"Main Depot"}),(0,P.jsx)("option",{value:"branch1",children:"Branch 1"}),(0,P.jsx)("option",{value:"branch2",children:"Branch 2"})]})]})]}),(0,P.jsxs)("div",{className:"filters-actions",children:[(0,P.jsx)("button",{className:"clear-filters-btn",onClick:()=>{$e({status:"all",type:"all",capacityRange:{min:0,max:100},depot:"all",lastMaintenance:"all",assignedCrew:"all"}),Je("default")},children:"Clear All Filters"}),(0,P.jsxs)("button",{className:"save-filter-btn",onClick:()=>{const e={id:"custom_".concat(Date.now()),name:"Custom Filter ".concat(Ue.length+1),filters:Ze};He(s=>[...s,e]),ts("Filter saved successfully!","success")},children:[(0,P.jsx)(g.A,{size:14}),"Save Filter"]})]})]}),te.length>0&&(0,P.jsxs)("div",{className:"bulk-actions-bar",children:[(0,P.jsxs)("div",{className:"bulk-info",children:[(0,P.jsx)(y,{size:16}),(0,P.jsxs)("span",{children:[te.length," buses selected"]}),(0,P.jsxs)("div",{className:"bulk-stats",children:[(0,P.jsxs)("span",{className:"stat-item",children:[(0,P.jsx)("span",{className:"stat-label",children:"Active:"}),(0,P.jsx)("span",{className:"stat-value",children:te.filter(e=>{var s;return"active"===(null===(s=U.find(s=>s._id===e))||void 0===s?void 0:s.status)}).length})]}),(0,P.jsxs)("span",{className:"stat-item",children:[(0,P.jsx)("span",{className:"stat-label",children:"Maintenance:"}),(0,P.jsx)("span",{className:"stat-value",children:te.filter(e=>{var s;return"maintenance"===(null===(s=U.find(s=>s._id===e))||void 0===s?void 0:s.status)}).length})]})]})]}),(0,P.jsxs)("div",{className:"bulk-actions",children:[(0,P.jsxs)("button",{className:"bulk-btn success",onClick:()=>As("activate"),title:"Activate Selected Buses",children:[(0,P.jsx)(c.A,{size:14}),"Activate"]}),(0,P.jsxs)("button",{className:"bulk-btn warning",onClick:()=>As("maintenance"),title:"Send to Maintenance",children:[(0,P.jsx)(u.A,{size:14}),"Maintenance"]}),(0,P.jsxs)("button",{className:"bulk-btn primary",onClick:()=>As("assign_route"),title:"Assign Route",children:[(0,P.jsx)(f.A,{size:14}),"Assign Route"]}),(0,P.jsxs)("button",{className:"bulk-btn primary",onClick:()=>As("assign_crew"),title:"Assign Crew",children:[(0,P.jsx)(A.A,{size:14}),"Assign Crew"]}),(0,P.jsxs)("button",{className:"bulk-btn secondary",onClick:()=>As("archive"),title:"Archive Buses",children:[(0,P.jsx)(C,{size:14}),"Archive"]}),(0,P.jsxs)("button",{className:"bulk-btn danger",onClick:()=>As("delete"),title:"Delete Buses",children:[(0,P.jsx)(k.A,{size:14}),"Delete"]}),(0,P.jsxs)("button",{className:"bulk-btn secondary",onClick:()=>ce([]),title:"Clear Selection",children:[(0,P.jsx)(r.A,{size:14}),"Clear"]})]})]}),(0,P.jsx)("div",{className:"table-section",children:(0,P.jsxs)("div",{className:"table-container",children:[(0,P.jsxs)("table",{className:"data-table",children:[(0,P.jsx)("thead",{children:(0,P.jsxs)("tr",{children:[(0,P.jsx)("th",{className:"select-column",children:(0,P.jsx)("button",{className:"select-all-btn",onClick:ys,children:te.length===gs.length?(0,P.jsx)(y,{size:16}):(0,P.jsx)(w.A,{size:16})})}),(0,P.jsx)("th",{className:"sortable",onClick:()=>Cs("busNumber"),children:(0,P.jsxs)("div",{className:"th-content",children:["Bus Number",(0,P.jsx)(S.A,{size:14})]})}),(0,P.jsx)("th",{className:"sortable",onClick:()=>Cs("registrationNumber"),children:(0,P.jsxs)("div",{className:"th-content",children:["Registration",(0,P.jsx)(S.A,{size:14})]})}),(0,P.jsx)("th",{className:"sortable",onClick:()=>Cs("busType"),children:(0,P.jsxs)("div",{className:"th-content",children:["Type",(0,P.jsx)(S.A,{size:14})]})}),(0,P.jsx)("th",{className:"sortable",onClick:()=>Cs("capacity"),children:(0,P.jsxs)("div",{className:"th-content",children:["Capacity",(0,P.jsx)(S.A,{size:14})]})}),(0,P.jsx)("th",{className:"sortable",onClick:()=>Cs("route"),children:(0,P.jsxs)("div",{className:"th-content",children:["Route",(0,P.jsx)(S.A,{size:14})]})}),(0,P.jsx)("th",{children:"Crew Assignment"}),(0,P.jsx)("th",{className:"sortable",onClick:()=>Cs("status"),children:(0,P.jsxs)("div",{className:"th-content",children:["Status",(0,P.jsx)(S.A,{size:14})]})}),(0,P.jsx)("th",{children:"Last Maintenance"}),(0,P.jsx)("th",{children:"Actions"})]})}),(0,P.jsx)("tbody",{children:gs.map(e=>{var s,a,i,l,n,t,c,r;return(0,P.jsxs)("tr",{className:te.includes(e._id)?"selected":"",children:[(0,P.jsx)("td",{className:"select-column",children:(0,P.jsx)("button",{className:"select-bus-btn",onClick:()=>fs(e._id),children:te.includes(e._id)?(0,P.jsx)(y,{size:14}):(0,P.jsx)(w.A,{size:14})})}),(0,P.jsx)("td",{children:(0,P.jsxs)("div",{className:"bus-info",children:[(0,P.jsx)("div",{className:"bus-number",children:e.busNumber}),(0,P.jsxs)("div",{className:"bus-id",children:["ID: ",e._id.slice(-6)]})]})}),(0,P.jsx)("td",{children:e.registrationNumber}),(0,P.jsx)("td",{children:(0,P.jsx)("span",{className:"bus-type-badge",children:rs(e.busType)})}),(0,P.jsx)("td",{children:(0,P.jsxs)("div",{className:"capacity-info",children:[(0,P.jsx)("span",{className:"capacity-total",children:(null===(s=e.capacity)||void 0===s?void 0:s.total)||0}),(0,P.jsxs)("span",{className:"capacity-detail",children:[(null===(a=e.capacity)||void 0===a?void 0:a.seater)||0,"S / ",(null===(i=e.capacity)||void 0===i?void 0:i.sleeper)||0,"SL"]})]})}),(0,P.jsx)("td",{children:(0,P.jsxs)("div",{className:"route-info",children:[(0,P.jsx)("div",{className:"route-name",children:(null===(l=e.currentRoute)||void 0===l?void 0:l.routeName)||(0,P.jsxs)("button",{className:"assign-route-btn",onClick:()=>{$(e),Ae(!0)},children:[(0,P.jsx)(f.A,{size:12}),"Assign Route"]})}),(0,P.jsx)("div",{className:"route-detail",children:null!==(n=e.currentRoute)&&void 0!==n&&n.routeNumber?"Route: ".concat(e.currentRoute.routeNumber):"No Route Assigned"})]})}),(0,P.jsx)("td",{children:(0,P.jsxs)("div",{className:"crew-info",children:[(0,P.jsxs)("div",{className:"crew-member",children:[(0,P.jsx)("span",{className:"crew-label",children:"Driver:"}),(0,P.jsx)("span",{className:"crew-name",children:(null===(t=e.assignedDriver)||void 0===t?void 0:t.name)||(0,P.jsxs)("button",{className:"assign-crew-btn",onClick:()=>{$(e),Le(!0)},children:[(0,P.jsx)(A.A,{size:10}),"Assign"]})})]}),(0,P.jsxs)("div",{className:"crew-member",children:[(0,P.jsx)("span",{className:"crew-label",children:"Conductor:"}),(0,P.jsx)("span",{className:"crew-name",children:(null===(c=e.assignedConductor)||void 0===c?void 0:c.name)||(0,P.jsxs)("button",{className:"assign-crew-btn",onClick:()=>{$(e),Le(!0)},children:[(0,P.jsx)(A.A,{size:10}),"Assign"]})})]})]})}),(0,P.jsx)("td",{children:(0,P.jsxs)("div",{className:"status-container",children:[(0,P.jsxs)("span",{className:"status-badge ".concat(ds(e.status)),children:[(0,P.jsx)("span",{className:"status-icon",children:(null===(r=ns[e.status])||void 0===r?void 0:r.icon)||"\u26aa"}),e.status]}),(0,P.jsxs)("div",{className:"quick-status-actions",children:["active"!==e.status&&(0,P.jsx)("button",{className:"quick-action-btn success",onClick:()=>ks(e._id,"active"),title:"Activate",children:(0,P.jsx)(M.A,{size:12})}),"maintenance"!==e.status&&(0,P.jsx)("button",{className:"quick-action-btn warning",onClick:()=>Ms(e),title:"Maintenance",children:(0,P.jsx)(u.A,{size:12})})]})]})}),(0,P.jsx)("td",{children:e.lastMaintenance?new Date(e.lastMaintenance).toLocaleDateString():"N/A"}),(0,P.jsx)("td",{children:(0,P.jsxs)("div",{className:"actions-container",children:[(0,P.jsxs)("div",{className:"primary-actions",children:[(0,P.jsxs)("button",{className:"action-card view",onClick:()=>ps(e),title:"View Details",children:[(0,P.jsx)(m.A,{size:14}),(0,P.jsx)("span",{children:"View"})]}),(0,P.jsxs)("button",{className:"action-card edit",onClick:()=>ps(e),title:"Edit Bus",children:[(0,P.jsx)(T.A,{size:14}),(0,P.jsx)("span",{children:"Edit"})]})]}),(0,P.jsxs)("div",{className:"secondary-actions",children:[(0,P.jsxs)("button",{className:"action-card maintenance",onClick:()=>ks(e._id,"maintenance"),title:"Send to Maintenance",children:[(0,P.jsx)(u.A,{size:14}),(0,P.jsx)("span",{children:"Maintenance"})]}),(0,P.jsxs)("div",{className:"actions-dropdown",children:[(0,P.jsxs)("button",{className:"action-card more",onClick:()=>{return s=e._id,void ge(be===s?null:s);var s},title:"More Actions",children:[(0,P.jsx)(z.A,{size:14}),(0,P.jsx)("span",{children:"More"})]}),be===e._id&&(0,P.jsxs)("div",{className:"dropdown-menu",children:[(0,P.jsxs)("button",{className:"dropdown-item",onClick:()=>js("duplicate",e),children:[(0,P.jsx)(D.A,{size:12}),"Duplicate"]}),(0,P.jsxs)("button",{className:"dropdown-item",onClick:()=>js("export",e),children:[(0,P.jsx)(j.A,{size:12}),"Export Data"]}),(0,P.jsxs)("button",{className:"dropdown-item",onClick:()=>js("history",e),children:[(0,P.jsx)(d.A,{size:12}),"Maintenance History"]}),(0,P.jsxs)("button",{className:"dropdown-item",onClick:()=>js("assign_route",e),children:[(0,P.jsx)(R.A,{size:12}),"Assign Route"]}),(0,P.jsx)("div",{className:"dropdown-divider"}),(0,P.jsxs)("button",{className:"dropdown-item danger",onClick:()=>(e=>{$(e),X(!0)})(e),children:[(0,P.jsx)(k.A,{size:12}),"Delete Bus"]})]})]})]})]})})]},e._id)})})]}),(0,P.jsxs)("div",{className:"pagination-section",children:[(0,P.jsx)("div",{className:"pagination-info",children:(0,P.jsxs)("span",{children:["Showing ",(me-1)*ve+1," to ",Math.min(me*ve,bs.length)," of ",bs.length," buses"]})}),(0,P.jsxs)("div",{className:"pagination-controls",children:[(0,P.jsxs)("button",{className:"pagination-btn",onClick:()=>he(e=>Math.max(1,e-1)),disabled:1===me,children:[(0,P.jsx)(_.A,{size:16}),"Previous"]}),(0,P.jsxs)("div",{className:"pagination-numbers",children:[Array.from({length:Math.min(5,Ns)},(e,s)=>{const a=s+1;return(0,P.jsx)("button",{className:"pagination-number ".concat(me===a?"active":""),onClick:()=>he(a),children:a},a)}),Ns>5&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("span",{className:"pagination-ellipsis",children:"..."}),(0,P.jsx)("button",{className:"pagination-number ".concat(me===Ns?"active":""),onClick:()=>he(Ns),children:Ns})]})]}),(0,P.jsxs)("button",{className:"pagination-btn",onClick:()=>he(e=>Math.min(Ns,e+1)),disabled:me===Ns,children:["Next",(0,P.jsx)(B.A,{size:16})]})]})]}),0===bs.length&&(0,P.jsxs)("div",{className:"no-data",children:[(0,P.jsxs)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:[(0,P.jsx)("path",{d:"M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"}),(0,P.jsx)("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})]}),(0,P.jsx)("h3",{children:"No buses found"}),(0,P.jsx)("p",{children:"Try adjusting your search or filters"})]})]})}),Y&&(0,P.jsx)("div",{className:"modal-overlay",children:(0,P.jsxs)("div",{className:"modal-content",children:[(0,P.jsxs)("div",{className:"modal-header",children:[(0,P.jsx)("h2",{children:"Add New Bus"}),(0,P.jsx)("button",{className:"modal-close",onClick:()=>{K(!1),xs()},children:(0,P.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,P.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),Qe.busNumber&&Qe.registrationNumber&&Qe.busType&&Qe.capacity.total)try{const e=await(0,t.nr)("/api/depot/buses",{method:"POST",body:JSON.stringify(Qe)});if(e.ok)K(!1),xs(),hs(),ts("Bus ".concat(Qe.busNumber," added successfully!"),"success");else{const s=e.message||"Failed to add bus";ts(s,"error")}}catch(s){console.error("Error adding bus:",s),ts("Failed to add bus. Please try again.","error")}else ts("Please fill in all required fields: Bus Number, Registration Number, Bus Type, and Total Capacity","error")},className:"bus-form",children:[(0,P.jsxs)("div",{className:"form-grid",children:[(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Bus Number *"}),(0,P.jsx)("input",{type:"text",value:Qe.busNumber,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{busNumber:e.target.value})),required:!0})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Registration Number *"}),(0,P.jsx)("input",{type:"text",value:Qe.registrationNumber,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{registrationNumber:e.target.value})),required:!0})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Bus Type *"}),(0,P.jsx)("select",{value:Qe.busType,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{busType:e.target.value})),required:!0,children:as.map(e=>(0,P.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Total Capacity *"}),(0,P.jsx)("input",{type:"number",value:Qe.capacity.total,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{capacity:(0,i.A)((0,i.A)({},Qe.capacity),{},{total:parseInt(e.target.value)})})),required:!0,min:"1"})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Seater Capacity"}),(0,P.jsx)("input",{type:"number",value:Qe.capacity.seater,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{capacity:(0,i.A)((0,i.A)({},Qe.capacity),{},{seater:parseInt(e.target.value)})})),min:"0"})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Sleeper Capacity"}),(0,P.jsx)("input",{type:"number",value:Qe.capacity.sleeper,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{capacity:(0,i.A)((0,i.A)({},Qe.capacity),{},{sleeper:parseInt(e.target.value)})})),min:"0"})]})]}),(0,P.jsxs)("div",{className:"form-section",children:[(0,P.jsx)("h3",{children:"Amenities"}),(0,P.jsx)("div",{className:"amenities-grid",children:is.map(e=>(0,P.jsxs)("label",{className:"checkbox-label",children:[(0,P.jsx)("input",{type:"checkbox",checked:Qe.amenities.includes(e.value),onChange:s=>{s.target.checked?Xe((0,i.A)((0,i.A)({},Qe),{},{amenities:[...Qe.amenities,e.value]})):Xe((0,i.A)((0,i.A)({},Qe),{},{amenities:Qe.amenities.filter(s=>s!==e.value)}))}}),(0,P.jsx)("span",{children:e.label})]},e.value))})]}),(0,P.jsxs)("div",{className:"form-section",children:[(0,P.jsx)("h3",{children:"Specifications"}),(0,P.jsxs)("div",{className:"form-grid",children:[(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Manufacturer"}),(0,P.jsx)("input",{type:"text",value:Qe.specifications.manufacturer,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{specifications:(0,i.A)((0,i.A)({},Qe.specifications),{},{manufacturer:e.target.value})}))})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Model"}),(0,P.jsx)("input",{type:"text",value:Qe.specifications.model,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{specifications:(0,i.A)((0,i.A)({},Qe.specifications),{},{model:e.target.value})}))})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Year"}),(0,P.jsx)("input",{type:"number",value:Qe.specifications.year,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{specifications:(0,i.A)((0,i.A)({},Qe.specifications),{},{year:parseInt(e.target.value)})})),min:"1900",max:(new Date).getFullYear()+1})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Fuel Type"}),(0,P.jsx)("select",{value:Qe.specifications.fuelType,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{specifications:(0,i.A)((0,i.A)({},Qe.specifications),{},{fuelType:e.target.value})})),children:ls.map(e=>(0,P.jsx)("option",{value:e.value,children:e.label},e.value))})]})]})]}),(0,P.jsxs)("div",{className:"form-section",children:[(0,P.jsx)("h3",{children:"Staff Assignment"}),(0,P.jsxs)("div",{className:"form-grid",children:[(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Assigned Driver"}),(0,P.jsxs)("select",{value:Qe.assignedDriver,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{assignedDriver:e.target.value})),disabled:Re,children:[(0,P.jsx)("option",{value:"",children:"Select Driver"}),Me.map(e=>{var s;return(0,P.jsxs)("option",{value:e._id,children:[e.name," (",e.driverId||e.employeeCode,") - ",(null===(s=e.drivingLicense)||void 0===s?void 0:s.licenseType)||"N/A"]},e._id)})]}),Re&&(0,P.jsx)("div",{className:"text-sm text-gray-500",children:"Loading drivers..."})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Assigned Conductor"}),(0,P.jsxs)("select",{value:Qe.assignedConductor,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{assignedConductor:e.target.value})),disabled:Re,children:[(0,P.jsx)("option",{value:"",children:"Select Conductor"}),ze.map(e=>(0,P.jsxs)("option",{value:e._id,children:[e.name," (",e.conductorId||e.employeeCode,") - ",e.badgeNumber||"N/A"]},e._id))]}),Re&&(0,P.jsx)("div",{className:"text-sm text-gray-500",children:"Loading conductors..."})]})]})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Notes"}),(0,P.jsx)("textarea",{value:Qe.notes,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{notes:e.target.value})),rows:"3"})]}),(0,P.jsxs)("div",{className:"modal-actions",children:[(0,P.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>{K(!1),xs()},children:"Cancel"}),(0,P.jsx)("button",{type:"submit",className:"btn-primary",children:"Add Bus"})]})]})]})}),G&&(0,P.jsx)("div",{className:"modal-overlay",children:(0,P.jsxs)("div",{className:"modal-content",children:[(0,P.jsxs)("div",{className:"modal-header",children:[(0,P.jsxs)("h2",{children:["Edit Bus - ",null===Z||void 0===Z?void 0:Z.busNumber]}),(0,P.jsx)("button",{className:"modal-close",onClick:()=>{W(!1),xs()},children:(0,P.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,P.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=await(0,t.nr)("/api/depot/buses/".concat(Z._id),{method:"PUT",body:JSON.stringify(Qe)});e.ok?(W(!1),xs(),hs(),ts("Bus ".concat(Qe.busNumber," updated successfully!"),"success")):ts(e.message||"Failed to update bus","error")}catch(s){console.error("Error updating bus:",s),ts("Failed to update bus. Please try again.","error")}},className:"bus-form",children:[(0,P.jsxs)("div",{className:"form-grid",children:[(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Bus Number *"}),(0,P.jsx)("input",{type:"text",value:Qe.busNumber,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{busNumber:e.target.value})),required:!0})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Registration Number *"}),(0,P.jsx)("input",{type:"text",value:Qe.registrationNumber,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{registrationNumber:e.target.value})),required:!0})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Bus Type *"}),(0,P.jsx)("select",{value:Qe.busType,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{busType:e.target.value})),required:!0,children:as.map(e=>(0,P.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Total Capacity *"}),(0,P.jsx)("input",{type:"number",value:Qe.capacity.total,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{capacity:(0,i.A)((0,i.A)({},Qe.capacity),{},{total:parseInt(e.target.value)})})),required:!0,min:"1"})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Seater Capacity"}),(0,P.jsx)("input",{type:"number",value:Qe.capacity.seater,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{capacity:(0,i.A)((0,i.A)({},Qe.capacity),{},{seater:parseInt(e.target.value)})})),min:"0"})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Sleeper Capacity"}),(0,P.jsx)("input",{type:"number",value:Qe.capacity.sleeper,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{capacity:(0,i.A)((0,i.A)({},Qe.capacity),{},{sleeper:parseInt(e.target.value)})})),min:"0"})]})]}),(0,P.jsxs)("div",{className:"form-section",children:[(0,P.jsx)("h3",{children:"Amenities"}),(0,P.jsx)("div",{className:"amenities-grid",children:is.map(e=>(0,P.jsxs)("label",{className:"checkbox-label",children:[(0,P.jsx)("input",{type:"checkbox",checked:Qe.amenities.includes(e.value),onChange:s=>{s.target.checked?Xe((0,i.A)((0,i.A)({},Qe),{},{amenities:[...Qe.amenities,e.value]})):Xe((0,i.A)((0,i.A)({},Qe),{},{amenities:Qe.amenities.filter(s=>s!==e.value)}))}}),(0,P.jsx)("span",{children:e.label})]},e.value))})]}),(0,P.jsxs)("div",{className:"form-section",children:[(0,P.jsx)("h3",{children:"Specifications"}),(0,P.jsxs)("div",{className:"form-grid",children:[(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Manufacturer"}),(0,P.jsx)("input",{type:"text",value:Qe.specifications.manufacturer,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{specifications:(0,i.A)((0,i.A)({},Qe.specifications),{},{manufacturer:e.target.value})}))})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Model"}),(0,P.jsx)("input",{type:"text",value:Qe.specifications.model,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{specifications:(0,i.A)((0,i.A)({},Qe.specifications),{},{model:e.target.value})}))})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Year"}),(0,P.jsx)("input",{type:"number",value:Qe.specifications.year,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{specifications:(0,i.A)((0,i.A)({},Qe.specifications),{},{year:parseInt(e.target.value)})})),min:"1900",max:(new Date).getFullYear()+1})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Fuel Type"}),(0,P.jsx)("select",{value:Qe.specifications.fuelType,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{specifications:(0,i.A)((0,i.A)({},Qe.specifications),{},{fuelType:e.target.value})})),children:ls.map(e=>(0,P.jsx)("option",{value:e.value,children:e.label},e.value))})]})]})]}),(0,P.jsxs)("div",{className:"form-section",children:[(0,P.jsx)("h3",{children:"Staff Assignment"}),(0,P.jsxs)("div",{className:"form-grid",children:[(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Assigned Driver"}),(0,P.jsxs)("select",{value:Qe.assignedDriver,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{assignedDriver:e.target.value})),disabled:Re,children:[(0,P.jsx)("option",{value:"",children:"Select Driver"}),Me.map(e=>{var s;return(0,P.jsxs)("option",{value:e._id,children:[e.name," (",e.driverId||e.employeeCode,") - ",(null===(s=e.drivingLicense)||void 0===s?void 0:s.licenseType)||"N/A"]},e._id)})]}),Re&&(0,P.jsx)("div",{className:"text-sm text-gray-500",children:"Loading drivers..."})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Assigned Conductor"}),(0,P.jsxs)("select",{value:Qe.assignedConductor,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{assignedConductor:e.target.value})),disabled:Re,children:[(0,P.jsx)("option",{value:"",children:"Select Conductor"}),ze.map(e=>(0,P.jsxs)("option",{value:e._id,children:[e.name," (",e.conductorId||e.employeeCode,") - ",e.badgeNumber||"N/A"]},e._id))]}),Re&&(0,P.jsx)("div",{className:"text-sm text-gray-500",children:"Loading conductors..."})]})]})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Notes"}),(0,P.jsx)("textarea",{value:Qe.notes,onChange:e=>Xe((0,i.A)((0,i.A)({},Qe),{},{notes:e.target.value})),rows:"3"})]}),(0,P.jsxs)("div",{className:"modal-actions",children:[(0,P.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>{W(!1),xs()},children:"Cancel"}),(0,P.jsx)("button",{type:"submit",className:"btn-primary",children:"Update Bus"})]})]})]})}),Q&&(0,P.jsx)("div",{className:"modal-overlay",children:(0,P.jsxs)("div",{className:"modal-content delete-modal",children:[(0,P.jsxs)("div",{className:"modal-header",children:[(0,P.jsx)("h2",{children:"Delete Bus"}),(0,P.jsx)("button",{className:"modal-close",onClick:()=>X(!1),children:(0,P.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,P.jsxs)("div",{className:"delete-content",children:[(0,P.jsx)("div",{className:"delete-icon",children:(0,P.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,P.jsx)("h3",{children:"Are you sure you want to delete this bus?"}),(0,P.jsxs)("p",{children:['This action cannot be undone. The bus "',null===Z||void 0===Z?void 0:Z.busNumber,'" will be permanently removed from your fleet.']}),(0,P.jsxs)("div",{className:"bus-details",children:[(0,P.jsxs)("div",{className:"detail-item",children:[(0,P.jsx)("span",{className:"label",children:"Bus Number:"}),(0,P.jsx)("span",{className:"value",children:null===Z||void 0===Z?void 0:Z.busNumber})]}),(0,P.jsxs)("div",{className:"detail-item",children:[(0,P.jsx)("span",{className:"label",children:"Registration:"}),(0,P.jsx)("span",{className:"value",children:null===Z||void 0===Z?void 0:Z.registrationNumber})]}),(0,P.jsxs)("div",{className:"detail-item",children:[(0,P.jsx)("span",{className:"label",children:"Type:"}),(0,P.jsx)("span",{className:"value",children:rs(null===Z||void 0===Z?void 0:Z.busType)})]})]})]}),(0,P.jsxs)("div",{className:"modal-actions",children:[(0,P.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>X(!1),children:"Cancel"}),(0,P.jsx)("button",{type:"button",className:"btn-danger",onClick:async()=>{try{const e=await(0,t.nr)("/api/depot/buses/".concat(Z._id),{method:"DELETE"});if(e.ok){X(!1);const e=Z.busNumber;$(null),hs(),ts("Bus ".concat(e," deleted successfully!"),"success")}else ts(e.message||"Failed to delete bus","error")}catch(e){console.error("Error deleting bus:",e),ts("Failed to delete bus. Please try again.","error")}},children:"Delete Bus"})]})]})}),fe&&Z&&(0,P.jsx)("div",{className:"modal-overlay",children:(0,P.jsxs)("div",{className:"modal-content",children:[(0,P.jsxs)("div",{className:"modal-header",children:[(0,P.jsxs)("h2",{children:["Assign Route to Bus - ",Z.busNumber]}),(0,P.jsx)("button",{className:"modal-close",onClick:()=>Ae(!1),children:(0,P.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,P.jsxs)("div",{className:"route-assignment-content",children:[(0,P.jsxs)("div",{className:"bus-info-card",children:[(0,P.jsx)("h3",{children:"Bus Information"}),(0,P.jsxs)("div",{className:"bus-details",children:[(0,P.jsxs)("div",{className:"detail-row",children:[(0,P.jsx)("span",{className:"label",children:"Bus Number:"}),(0,P.jsx)("span",{className:"value",children:Z.busNumber})]}),(0,P.jsxs)("div",{className:"detail-row",children:[(0,P.jsx)("span",{className:"label",children:"Registration:"}),(0,P.jsx)("span",{className:"value",children:Z.registrationNumber})]}),(0,P.jsxs)("div",{className:"detail-row",children:[(0,P.jsx)("span",{className:"label",children:"Type:"}),(0,P.jsx)("span",{className:"value",children:rs(Z.busType)})]}),(0,P.jsxs)("div",{className:"detail-row",children:[(0,P.jsx)("span",{className:"label",children:"Current Route:"}),(0,P.jsx)("span",{className:"value",children:(null===(e=Z.currentRoute)||void 0===e?void 0:e.routeName)||"No Route Assigned"})]})]})]}),(0,P.jsxs)("div",{className:"route-selection",children:[(0,P.jsx)("h3",{children:"Select Route to Assign"}),we?(0,P.jsxs)("div",{className:"loading-state",children:[(0,P.jsx)("div",{className:"loading-spinner"}),(0,P.jsx)("p",{children:"Loading available routes..."})]}):0===Ce.length?(0,P.jsxs)("div",{className:"no-routes",children:[(0,P.jsx)("p",{children:"No active routes available. Please create routes first."}),(0,P.jsx)("button",{className:"btn-primary",onClick:()=>{Ae(!1),window.open("/admin/routes","_blank")},children:"Go to Routes Management"})]}):(0,P.jsx)("div",{className:"routes-grid",children:Ce.map(e=>{var s,a,i,l;return(0,P.jsxs)("div",{className:"route-card",onClick:()=>(async e=>{if(Z&&e)try{const s=await(0,t.nr)("/api/depot/buses/".concat(Z._id,"/assign-route"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({routeId:e})});if(s.ok)ts("Route assigned to bus ".concat(Z.busNumber," successfully!"),"success"),Ae(!1),$(null),hs();else{const e=s.data||s;ts(e.message||"Failed to assign route","error")}}catch(s){console.error("Error assigning route:",s),ts("Failed to assign route. Please try again.","error")}else ts("Please select a bus and route","error")})(e._id),children:[(0,P.jsxs)("div",{className:"route-header",children:[(0,P.jsx)("h4",{children:e.routeName}),(0,P.jsx)("span",{className:"route-number",children:e.routeNumber})]}),(0,P.jsxs)("div",{className:"route-details",children:[(0,P.jsxs)("div",{className:"route-path",children:[(0,P.jsx)("span",{className:"from",children:(null===(s=e.startingPoint)||void 0===s?void 0:s.city)||e.startingPoint}),(0,P.jsx)("span",{className:"arrow",children:"\u2192"}),(0,P.jsx)("span",{className:"to",children:(null===(a=e.endingPoint)||void 0===a?void 0:a.city)||e.endingPoint})]}),(0,P.jsxs)("div",{className:"route-info",children:[(0,P.jsxs)("span",{className:"distance",children:[e.totalDistance," km"]}),(0,P.jsxs)("span",{className:"duration",children:[Math.floor(e.estimatedDuration/60),"h ",e.estimatedDuration%60,"m"]}),(0,P.jsxs)("span",{className:"fare",children:["\u20b9",e.baseFare]})]}),(0,P.jsxs)("div",{className:"route-features",children:[null===(i=e.features)||void 0===i?void 0:i.slice(0,3).map((e,s)=>(0,P.jsx)("span",{className:"feature-tag",children:e},s)),(null===(l=e.features)||void 0===l?void 0:l.length)>3&&(0,P.jsxs)("span",{className:"feature-tag",children:["+",e.features.length-3]})]})]}),(0,P.jsx)("div",{className:"assign-button",children:(0,P.jsx)("button",{className:"btn-assign",children:"Assign Route"})})]},e._id)})})]})]}),(0,P.jsx)("div",{className:"modal-actions",children:(0,P.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>Ae(!1),children:"Cancel"})})]})}),Be&&(0,P.jsx)("div",{className:"modal-overlay",children:(0,P.jsxs)("div",{className:"modal-content",children:[(0,P.jsxs)("div",{className:"modal-header",children:[(0,P.jsx)("h2",{children:"Create Maintenance Log"}),(0,P.jsx)("button",{className:"modal-close",onClick:()=>Fe(!1),children:(0,P.jsx)(r.A,{size:20})})]}),(0,P.jsxs)("form",{onSubmit:Ss,className:"maintenance-form",children:[(0,P.jsxs)("div",{className:"form-grid",children:[(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Bus *"}),(0,P.jsxs)("select",{value:es.busId,onChange:e=>ss(s=>(0,i.A)((0,i.A)({},s),{},{busId:e.target.value})),required:!0,children:[(0,P.jsx)("option",{value:"",children:"Select Bus"}),U.map(e=>(0,P.jsxs)("option",{value:e._id,children:[e.busNumber," - ",e.registrationNumber]},e._id))]})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Problem Type *"}),(0,P.jsxs)("select",{value:es.problemType,onChange:e=>ss(s=>(0,i.A)((0,i.A)({},s),{},{problemType:e.target.value})),required:!0,children:[(0,P.jsx)("option",{value:"",children:"Select Problem Type"}),[{value:"engine",label:"Engine Issues"},{value:"tires",label:"Tire Problems"},{value:"brakes",label:"Brake System"},{value:"electrical",label:"Electrical"},{value:"air_conditioning",label:"Air Conditioning"},{value:"transmission",label:"Transmission"},{value:"suspension",label:"Suspension"},{value:"documents",label:"Documentation"},{value:"other",label:"Other"}].map(e=>(0,P.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Priority *"}),(0,P.jsx)("select",{value:es.priority,onChange:e=>ss(s=>(0,i.A)((0,i.A)({},s),{},{priority:e.target.value})),required:!0,children:[{value:"low",label:"Low",color:"green"},{value:"medium",label:"Medium",color:"orange"},{value:"high",label:"High",color:"red"},{value:"critical",label:"Critical",color:"red"}].map(e=>(0,P.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Assigned Mechanic"}),(0,P.jsx)("input",{type:"text",value:es.assignedMechanic,onChange:e=>ss(s=>(0,i.A)((0,i.A)({},s),{},{assignedMechanic:e.target.value})),placeholder:"Enter mechanic name"})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Estimated Return Time"}),(0,P.jsx)("input",{type:"datetime-local",value:es.estimatedReturnTime,onChange:e=>ss(s=>(0,i.A)((0,i.A)({},s),{},{estimatedReturnTime:e.target.value}))})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Estimated Cost (\u20b9)"}),(0,P.jsx)("input",{type:"number",value:es.estimatedCost,onChange:e=>ss(s=>(0,i.A)((0,i.A)({},s),{},{estimatedCost:parseFloat(e.target.value)||0})),min:"0",step:"0.01"})]})]}),(0,P.jsxs)("div",{className:"form-group",children:[(0,P.jsx)("label",{children:"Description *"}),(0,P.jsx)("textarea",{value:es.description,onChange:e=>ss(s=>(0,i.A)((0,i.A)({},s),{},{description:e.target.value})),rows:"4",placeholder:"Describe the problem and required repairs...",required:!0})]}),(0,P.jsxs)("div",{className:"modal-actions",children:[(0,P.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>Fe(!1),children:"Cancel"}),(0,P.jsx)("button",{type:"submit",className:"btn-primary",children:"Create Maintenance Log"})]})]})]})}),Ee&&Z&&(0,P.jsx)("div",{className:"modal-overlay",children:(0,P.jsxs)("div",{className:"modal-content",children:[(0,P.jsxs)("div",{className:"modal-header",children:[(0,P.jsxs)("h2",{children:["Assign Crew to Bus - ",Z.busNumber]}),(0,P.jsx)("button",{className:"modal-close",onClick:()=>Le(!1),children:(0,P.jsx)(r.A,{size:20})})]}),(0,P.jsxs)("div",{className:"crew-assignment-content",children:[(0,P.jsxs)("div",{className:"bus-info-card",children:[(0,P.jsx)("h3",{children:"Bus Information"}),(0,P.jsxs)("div",{className:"bus-details",children:[(0,P.jsxs)("div",{className:"detail-row",children:[(0,P.jsx)("span",{className:"label",children:"Bus Number:"}),(0,P.jsx)("span",{className:"value",children:Z.busNumber})]}),(0,P.jsxs)("div",{className:"detail-row",children:[(0,P.jsx)("span",{className:"label",children:"Registration:"}),(0,P.jsx)("span",{className:"value",children:Z.registrationNumber})]}),(0,P.jsxs)("div",{className:"detail-row",children:[(0,P.jsx)("span",{className:"label",children:"Type:"}),(0,P.jsx)("span",{className:"value",children:rs(Z.busType)})]})]})]}),(0,P.jsxs)("div",{className:"crew-selection",children:[(0,P.jsx)("h3",{children:"Select Crew Members"}),(0,P.jsxs)("div",{className:"crew-grid",children:[(0,P.jsxs)("div",{className:"crew-section",children:[(0,P.jsx)("h4",{children:"Driver"}),(null===(s=Z.assignedDriver)||void 0===s?void 0:s.name)&&(0,P.jsxs)("div",{className:"current-assignment",children:[(0,P.jsx)("span",{className:"current-label",children:"Currently assigned:"}),(0,P.jsx)("span",{className:"current-name",children:Z.assignedDriver.name})]}),(0,P.jsxs)("select",{className:"crew-select",value:(null===(a=Z.assignedDriver)||void 0===a?void 0:a._id)||Z.assignedDriver||"",onChange:async e=>{try{var s;const a=await(0,t.nr)("/api/depot/buses/".concat(Z._id,"/assign-crew"),{method:"POST",body:JSON.stringify({driverId:e.target.value,conductorId:(null===(s=Z.assignedConductor)||void 0===s?void 0:s._id)||Z.assignedConductor||null})});if(a.ok){ts("Driver assigned successfully!","success");const s=Me.find(s=>s._id===e.target.value);$(a=>(0,i.A)((0,i.A)({},a),{},{assignedDriver:s||e.target.value})),hs()}else ts(a.message||"Failed to assign driver","error")}catch(a){console.error("Error assigning driver:",a),ts("Failed to assign driver","error")}},children:[(0,P.jsx)("option",{value:"",children:"Select Driver"}),Me.map(e=>(0,P.jsxs)("option",{value:e._id,children:[e.name," (",e.driverId||e.employeeCode,")"]},e._id))]})]}),(0,P.jsxs)("div",{className:"crew-section",children:[(0,P.jsx)("h4",{children:"Conductor"}),(null===(N=Z.assignedConductor)||void 0===N?void 0:N.name)&&(0,P.jsxs)("div",{className:"current-assignment",children:[(0,P.jsx)("span",{className:"current-label",children:"Currently assigned:"}),(0,P.jsx)("span",{className:"current-name",children:Z.assignedConductor.name})]}),(0,P.jsxs)("select",{className:"crew-select",value:(null===(O=Z.assignedConductor)||void 0===O?void 0:O._id)||Z.assignedConductor||"",onChange:async e=>{try{var s;const a=await(0,t.nr)("/api/depot/buses/".concat(Z._id,"/assign-crew"),{method:"POST",body:JSON.stringify({driverId:(null===(s=Z.assignedDriver)||void 0===s?void 0:s._id)||Z.assignedDriver||null,conductorId:e.target.value})});if(a.ok){ts("Conductor assigned successfully!","success");const s=ze.find(s=>s._id===e.target.value);$(a=>(0,i.A)((0,i.A)({},a),{},{assignedConductor:s||e.target.value})),hs()}else ts(a.message||"Failed to assign conductor","error")}catch(a){console.error("Error assigning conductor:",a),ts("Failed to assign conductor","error")}},children:[(0,P.jsx)("option",{value:"",children:"Select Conductor"}),ze.map(e=>(0,P.jsxs)("option",{value:e._id,children:[e.name," (",e.conductorId||e.employeeCode,")"]},e._id))]})]})]})]})]}),(0,P.jsx)("div",{className:"modal-actions",children:(0,P.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>Le(!1),children:"Close"})})]})}),Ie&&(0,P.jsx)("div",{className:"modal-overlay",children:(0,P.jsxs)("div",{className:"modal-content export-modal",children:[(0,P.jsxs)("div",{className:"modal-header",children:[(0,P.jsx)("h2",{children:"Export Fleet Data"}),(0,P.jsx)("button",{className:"modal-close",onClick:()=>Pe(!1),children:(0,P.jsx)(r.A,{size:20})})]}),(0,P.jsxs)("div",{className:"export-content",children:[(0,P.jsxs)("div",{className:"export-options",children:[(0,P.jsx)("h3",{children:"Export Format"}),(0,P.jsxs)("div",{className:"format-buttons",children:[(0,P.jsxs)("button",{className:"format-btn excel",onClick:()=>Ts("excel"),children:[(0,P.jsx)(F.A,{size:24}),(0,P.jsx)("span",{children:"Excel (.xlsx)"}),(0,P.jsx)("small",{children:"Detailed spreadsheet with all data"})]}),(0,P.jsxs)("button",{className:"format-btn pdf",onClick:()=>Ts("pdf"),children:[(0,P.jsx)(F.A,{size:24}),(0,P.jsx)("span",{children:"PDF Report"}),(0,P.jsx)("small",{children:"Formatted report for printing"})]})]})]}),(0,P.jsxs)("div",{className:"export-stats",children:[(0,P.jsx)("h3",{children:"Report Summary"}),(0,P.jsxs)("div",{className:"stats-grid",children:[(0,P.jsxs)("div",{className:"stat-card",children:[(0,P.jsx)("div",{className:"stat-icon",children:(0,P.jsx)(E.A,{size:20})}),(0,P.jsxs)("div",{className:"stat-content",children:[(0,P.jsx)("div",{className:"stat-value",children:Ge.totalTrips}),(0,P.jsx)("div",{className:"stat-label",children:"Total Trips"})]})]}),(0,P.jsxs)("div",{className:"stat-card",children:[(0,P.jsx)("div",{className:"stat-icon",children:(0,P.jsx)(L.A,{size:20})}),(0,P.jsxs)("div",{className:"stat-content",children:[(0,P.jsxs)("div",{className:"stat-value",children:[Ge.totalKm," km"]}),(0,P.jsx)("div",{className:"stat-label",children:"Total Distance"})]})]}),(0,P.jsxs)("div",{className:"stat-card",children:[(0,P.jsx)("div",{className:"stat-icon",children:(0,P.jsx)(I.A,{size:20})}),(0,P.jsxs)("div",{className:"stat-content",children:[(0,P.jsx)("div",{className:"stat-value",children:Ge.avgFuelEfficiency}),(0,P.jsx)("div",{className:"stat-label",children:"Avg Fuel Efficiency"})]})]}),(0,P.jsxs)("div",{className:"stat-card",children:[(0,P.jsx)("div",{className:"stat-icon",children:(0,P.jsx)(d.A,{size:20})}),(0,P.jsxs)("div",{className:"stat-content",children:[(0,P.jsxs)("div",{className:"stat-value",children:[Ge.downtimeHours,"h"]}),(0,P.jsx)("div",{className:"stat-label",children:"Downtime"})]})]})]})]})]}),(0,P.jsx)("div",{className:"modal-actions",children:(0,P.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>Pe(!1),children:"Cancel"})})]})})]})}}}]);
//# sourceMappingURL=25.4e115d9b.chunk.js.map